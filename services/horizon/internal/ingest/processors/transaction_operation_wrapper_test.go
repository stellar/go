//lint:file-ignore U1001 Ignore all unused code, staticcheck doesn't understand testify/suite

package processors

import (
	"testing"

	"github.com/stretchr/testify/assert"
	"github.com/stretchr/testify/suite"

	"github.com/stellar/go/ingest"
	"github.com/stellar/go/services/horizon/internal/db2/history"
	. "github.com/stellar/go/services/horizon/internal/test/transactions"
	"github.com/stellar/go/xdr"
)

func TestTransactionOperationID(t *testing.T) {
	tt := assert.New(t)
	transaction := BuildLedgerTransaction(
		t,
		TestTransaction{
			Index:         1,
			EnvelopeXDR:   "AAAAABpcjiETZ0uhwxJJhgBPYKWSVJy2TZ2LI87fqV1cUf/UAAAAZAAAADcAAAABAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAGlyOIRNnS6HDEkmGAE9gpZJUnLZNnYsjzt+pXVxR/9QAAAAAAAAAAAX14QAAAAAAAAAAAVxR/9QAAABAK6pcXYMzAEmH08CZ1LWmvtNDKauhx+OImtP/Lk4hVTMJRVBOebVs5WEPj9iSrgGT0EswuDCZ2i5AEzwgGof9Ag==",
			ResultXDR:     "AAAAAAAAAGQAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAA=",
			MetaXDR:       "AAAAAQAAAAIAAAADAAAAOAAAAAAAAAAAGlyOIRNnS6HDEkmGAE9gpZJUnLZNnYsjzt+pXVxR/9QAAAACVAvjnAAAADcAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAABAAAAOAAAAAAAAAAAGlyOIRNnS6HDEkmGAE9gpZJUnLZNnYsjzt+pXVxR/9QAAAACVAvjnAAAADcAAAABAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAABAAAAAA==",
			FeeChangesXDR: "AAAAAgAAAAMAAAA3AAAAAAAAAAAaXI4hE2dLocMSSYYAT2ClklSctk2diyPO36ldXFH/1AAAAAJUC+QAAAAANwAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAEAAAA4AAAAAAAAAAAaXI4hE2dLocMSSYYAT2ClklSctk2diyPO36ldXFH/1AAAAAJUC+OcAAAANwAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA==",
			Hash:          "2a805712c6d10f9e74bb0ccf54ae92a2b4b1e586451fe8133a2433816f6b567c",
		},
	)

	operation := transactionOperationWrapper{
		index:          0,
		transaction:    transaction,
		operation:      transaction.Envelope.Operations()[0],
		ledgerSequence: 56,
	}

	tt.Equal(int64(240518172673), operation.ID())
}

func TestTransactionOperationOrder(t *testing.T) {
	tt := assert.New(t)
	transaction := BuildLedgerTransaction(
		t,
		TestTransaction{
			Index:         1,
			EnvelopeXDR:   "AAAAABpcjiETZ0uhwxJJhgBPYKWSVJy2TZ2LI87fqV1cUf/UAAAAZAAAADcAAAABAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAGlyOIRNnS6HDEkmGAE9gpZJUnLZNnYsjzt+pXVxR/9QAAAAAAAAAAAX14QAAAAAAAAAAAVxR/9QAAABAK6pcXYMzAEmH08CZ1LWmvtNDKauhx+OImtP/Lk4hVTMJRVBOebVs5WEPj9iSrgGT0EswuDCZ2i5AEzwgGof9Ag==",
			ResultXDR:     "AAAAAAAAAGQAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAA=",
			MetaXDR:       "AAAAAQAAAAIAAAADAAAAOAAAAAAAAAAAGlyOIRNnS6HDEkmGAE9gpZJUnLZNnYsjzt+pXVxR/9QAAAACVAvjnAAAADcAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAABAAAAOAAAAAAAAAAAGlyOIRNnS6HDEkmGAE9gpZJUnLZNnYsjzt+pXVxR/9QAAAACVAvjnAAAADcAAAABAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAABAAAAAA==",
			FeeChangesXDR: "AAAAAgAAAAMAAAA3AAAAAAAAAAAaXI4hE2dLocMSSYYAT2ClklSctk2diyPO36ldXFH/1AAAAAJUC+QAAAAANwAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAEAAAA4AAAAAAAAAAAaXI4hE2dLocMSSYYAT2ClklSctk2diyPO36ldXFH/1AAAAAJUC+OcAAAANwAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA==",
			Hash:          "2a805712c6d10f9e74bb0ccf54ae92a2b4b1e586451fe8133a2433816f6b567c",
		},
	)

	operation := transactionOperationWrapper{
		index:          0,
		transaction:    transaction,
		operation:      transaction.Envelope.Operations()[0],
		ledgerSequence: 1,
	}

	tt.Equal(uint32(1), operation.Order())
}

func TestTransactionOperationTransactionID(t *testing.T) {
	tt := assert.New(t)
	transaction := BuildLedgerTransaction(
		t,
		TestTransaction{
			Index:         1,
			EnvelopeXDR:   "AAAAABpcjiETZ0uhwxJJhgBPYKWSVJy2TZ2LI87fqV1cUf/UAAAAZAAAADcAAAABAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAGlyOIRNnS6HDEkmGAE9gpZJUnLZNnYsjzt+pXVxR/9QAAAAAAAAAAAX14QAAAAAAAAAAAVxR/9QAAABAK6pcXYMzAEmH08CZ1LWmvtNDKauhx+OImtP/Lk4hVTMJRVBOebVs5WEPj9iSrgGT0EswuDCZ2i5AEzwgGof9Ag==",
			ResultXDR:     "AAAAAAAAAGQAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAA=",
			MetaXDR:       "AAAAAQAAAAIAAAADAAAAOAAAAAAAAAAAGlyOIRNnS6HDEkmGAE9gpZJUnLZNnYsjzt+pXVxR/9QAAAACVAvjnAAAADcAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAABAAAAOAAAAAAAAAAAGlyOIRNnS6HDEkmGAE9gpZJUnLZNnYsjzt+pXVxR/9QAAAACVAvjnAAAADcAAAABAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAABAAAAAA==",
			FeeChangesXDR: "AAAAAgAAAAMAAAA3AAAAAAAAAAAaXI4hE2dLocMSSYYAT2ClklSctk2diyPO36ldXFH/1AAAAAJUC+QAAAAANwAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAEAAAA4AAAAAAAAAAAaXI4hE2dLocMSSYYAT2ClklSctk2diyPO36ldXFH/1AAAAAJUC+OcAAAANwAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA==",
			Hash:          "2a805712c6d10f9e74bb0ccf54ae92a2b4b1e586451fe8133a2433816f6b567c",
		},
	)
	operation := transactionOperationWrapper{
		index:          0,
		transaction:    transaction,
		operation:      transaction.Envelope.Operations()[0],
		ledgerSequence: 56,
	}

	tt.Equal(int64(240518172672), operation.TransactionID())
}

func TestOperationTransactionSourceAccount(t *testing.T) {
	testCases := []struct {
		desc          string
		sourceAccount string
		expected      string
	}{
		{
			desc:          "Operation without source account",
			sourceAccount: "",
			expected:      "GANFZDRBCNTUXIODCJEYMACPMCSZEVE4WZGZ3CZDZ3P2SXK4KH75IK6Y",
		},
		{
			desc:          "Operation with source account",
			sourceAccount: "GDMQUXK7ZUCWM5472ZU3YLDP4BMJLQQ76DEMNYDEY2ODEEGGRKLEWGW2",
			expected:      "GDMQUXK7ZUCWM5472ZU3YLDP4BMJLQQ76DEMNYDEY2ODEEGGRKLEWGW2",
		},
	}
	for _, tc := range testCases {
		t.Run(tc.desc, func(t *testing.T) {
			tt := assert.New(t)
			transaction := BuildLedgerTransaction(
				t,
				TestTransaction{
					Index:         1,
					EnvelopeXDR:   "AAAAABpcjiETZ0uhwxJJhgBPYKWSVJy2TZ2LI87fqV1cUf/UAAAAZAAAADcAAAABAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAGlyOIRNnS6HDEkmGAE9gpZJUnLZNnYsjzt+pXVxR/9QAAAAAAAAAAAX14QAAAAAAAAAAAVxR/9QAAABAK6pcXYMzAEmH08CZ1LWmvtNDKauhx+OImtP/Lk4hVTMJRVBOebVs5WEPj9iSrgGT0EswuDCZ2i5AEzwgGof9Ag==",
					ResultXDR:     "AAAAAAAAAGQAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAA=",
					MetaXDR:       "AAAAAQAAAAIAAAADAAAAOAAAAAAAAAAAGlyOIRNnS6HDEkmGAE9gpZJUnLZNnYsjzt+pXVxR/9QAAAACVAvjnAAAADcAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAABAAAAOAAAAAAAAAAAGlyOIRNnS6HDEkmGAE9gpZJUnLZNnYsjzt+pXVxR/9QAAAACVAvjnAAAADcAAAABAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAABAAAAAA==",
					FeeChangesXDR: "AAAAAgAAAAMAAAA3AAAAAAAAAAAaXI4hE2dLocMSSYYAT2ClklSctk2diyPO36ldXFH/1AAAAAJUC+QAAAAANwAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAEAAAA4AAAAAAAAAAAaXI4hE2dLocMSSYYAT2ClklSctk2diyPO36ldXFH/1AAAAAJUC+OcAAAANwAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA==",
					Hash:          "2a805712c6d10f9e74bb0ccf54ae92a2b4b1e586451fe8133a2433816f6b567c",
				},
			)
			op := transaction.Envelope.Operations()[0]
			if len(tc.sourceAccount) > 0 {
				aid := xdr.MustAddress(tc.sourceAccount)
				sourceAccount := aid.ToMuxedAccount()
				op.SourceAccount = &sourceAccount
			}

			operation := transactionOperationWrapper{
				index:          1,
				transaction:    transaction,
				operation:      op,
				ledgerSequence: 1,
			}

			tt.Equal(tc.expected, operation.SourceAccount().Address())
		})
	}
}

func TestTransactionOperationType(t *testing.T) {
	tt := assert.New(t)
	transaction := BuildLedgerTransaction(
		t,
		TestTransaction{
			Index:         1,
			EnvelopeXDR:   "AAAAABpcjiETZ0uhwxJJhgBPYKWSVJy2TZ2LI87fqV1cUf/UAAAAZAAAADcAAAABAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAGlyOIRNnS6HDEkmGAE9gpZJUnLZNnYsjzt+pXVxR/9QAAAAAAAAAAAX14QAAAAAAAAAAAVxR/9QAAABAK6pcXYMzAEmH08CZ1LWmvtNDKauhx+OImtP/Lk4hVTMJRVBOebVs5WEPj9iSrgGT0EswuDCZ2i5AEzwgGof9Ag==",
			ResultXDR:     "AAAAAAAAAGQAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAA=",
			MetaXDR:       "AAAAAQAAAAIAAAADAAAAOAAAAAAAAAAAGlyOIRNnS6HDEkmGAE9gpZJUnLZNnYsjzt+pXVxR/9QAAAACVAvjnAAAADcAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAABAAAAOAAAAAAAAAAAGlyOIRNnS6HDEkmGAE9gpZJUnLZNnYsjzt+pXVxR/9QAAAACVAvjnAAAADcAAAABAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAABAAAAAA==",
			FeeChangesXDR: "AAAAAgAAAAMAAAA3AAAAAAAAAAAaXI4hE2dLocMSSYYAT2ClklSctk2diyPO36ldXFH/1AAAAAJUC+QAAAAANwAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAEAAAA4AAAAAAAAAAAaXI4hE2dLocMSSYYAT2ClklSctk2diyPO36ldXFH/1AAAAAJUC+OcAAAANwAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA==",
			Hash:          "2a805712c6d10f9e74bb0ccf54ae92a2b4b1e586451fe8133a2433816f6b567c",
		},
	)

	operation := transactionOperationWrapper{
		index:          1,
		transaction:    transaction,
		operation:      transaction.Envelope.Operations()[0],
		ledgerSequence: 1,
	}

	tt.Equal(xdr.OperationTypePayment, operation.OperationType())
}

func getRevokeSponsorshipEnvelopeXDR(t *testing.T) string {
	source := xdr.MustMuxedAddress("GAUJETIZVEP2NRYLUESJ3LS66NVCEGMON4UDCBCSBEVPIID773P2W6AY")
	env := &xdr.TransactionEnvelope{
		Type: xdr.EnvelopeTypeEnvelopeTypeTx,
		V1: &xdr.TransactionV1Envelope{
			Tx: xdr.Transaction{
				SourceAccount: source,
				Memo:          xdr.Memo{Type: xdr.MemoTypeMemoNone},
				Operations: []xdr.Operation{
					{
						SourceAccount: &source,
						Body: xdr.OperationBody{
							Type: xdr.OperationTypeRevokeSponsorship,
							RevokeSponsorshipOp: &xdr.RevokeSponsorshipOp{
								Type: xdr.RevokeSponsorshipTypeRevokeSponsorshipSigner,
								Signer: &xdr.RevokeSponsorshipOpSigner{
									AccountId: xdr.MustAddress("GAHK7EEG2WWHVKDNT4CEQFZGKF2LGDSW2IVM4S5DP42RBW3K6BTODB4A"),
									SignerKey: xdr.MustSigner("GCAHY6JSXQFKWKP6R7U5JPXDVNV4DJWOWRFLY3Y6YPBF64QRL4BPFDNS"),
								},
							},
						},
					},
				},
			},
		},
	}
	b64, err := xdr.MarshalBase64(env)
	assert.NoError(t, err)
	return b64
}

func TestTransactionOperationDetails(t *testing.T) {
	testCases := []struct {
		desc          string
		envelopeXDR   string
		resultXDR     string
		metaXDR       string
		feeChangesXDR string
		hash          string
		index         uint32
		expected      map[string]interface{}
	}{
		{
			desc:          "createAccount",
			envelopeXDR:   "AAAAAGL8HQvQkbK2HA3WVjRrKmjX00fG8sLI7m0ERwJW/AX3AAAAZAAAAAAAAAAaAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAoZftFP3p4ifbTm6hQdieotu3Zw9E05GtoSh5MBytEpQAAAACVAvkAAAAAAAAAAABVvwF9wAAAEDHU95E9wxgETD8TqxUrkgC0/7XHyNDts6Q5huRHfDRyRcoHdv7aMp/sPvC3RPkXjOMjgbKJUX7SgExUeYB5f8F",
			resultXDR:     "AAAAAAAAAGQAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAA=",
			metaXDR:       "AAAAAQAAAAIAAAADAAAAOQAAAAAAAAAAYvwdC9CRsrYcDdZWNGsqaNfTR8bywsjubQRHAlb8BfcLGrZY9dZxbAAAAAAAAAAZAAAAAAAAAAEAAAAAYvwdC9CRsrYcDdZWNGsqaNfTR8bywsjubQRHAlb8BfcAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAABAAAAOQAAAAAAAAAAYvwdC9CRsrYcDdZWNGsqaNfTR8bywsjubQRHAlb8BfcLGrZY9dZxbAAAAAAAAAAaAAAAAAAAAAEAAAAAYvwdC9CRsrYcDdZWNGsqaNfTR8bywsjubQRHAlb8BfcAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAABAAAAAwAAAAMAAAA5AAAAAAAAAABi/B0L0JGythwN1lY0aypo19NHxvLCyO5tBEcCVvwF9wsatlj11nFsAAAAAAAAABoAAAAAAAAAAQAAAABi/B0L0JGythwN1lY0aypo19NHxvLCyO5tBEcCVvwF9wAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAEAAAA5AAAAAAAAAABi/B0L0JGythwN1lY0aypo19NHxvLCyO5tBEcCVvwF9wsatlahyo1sAAAAAAAAABoAAAAAAAAAAQAAAABi/B0L0JGythwN1lY0aypo19NHxvLCyO5tBEcCVvwF9wAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAA5AAAAAAAAAAChl+0U/eniJ9tObqFB2J6i27dnD0TTka2hKHkwHK0SlAAAAAJUC+QAAAAAOQAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA==",
			feeChangesXDR: "AAAAAgAAAAMAAAA3AAAAAAAAAABi/B0L0JGythwN1lY0aypo19NHxvLCyO5tBEcCVvwF9wsatlj11nHQAAAAAAAAABkAAAAAAAAAAQAAAABi/B0L0JGythwN1lY0aypo19NHxvLCyO5tBEcCVvwF9wAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAEAAAA5AAAAAAAAAABi/B0L0JGythwN1lY0aypo19NHxvLCyO5tBEcCVvwF9wsatlj11nFsAAAAAAAAABkAAAAAAAAAAQAAAABi/B0L0JGythwN1lY0aypo19NHxvLCyO5tBEcCVvwF9wAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA==",
			hash:          "0e5bd332291e3098e49886df2cdb9b5369a5f9e0a9973f0d9e1a9489c6581ba2",
			index:         0,
			expected: map[string]interface{}{
				"account":          "GCQZP3IU7XU6EJ63JZXKCQOYT2RNXN3HB5CNHENNUEUHSMA4VUJJJSEN",
				"funder":           "GBRPYHIL2CI3FNQ4BXLFMNDLFJUNPU2HY3ZMFSHONUCEOASW7QC7OX2H",
				"starting_balance": "1000.0000000",
			},
		},
		{
			desc:          "payment",
			envelopeXDR:   "AAAAABpcjiETZ0uhwxJJhgBPYKWSVJy2TZ2LI87fqV1cUf/UAAAAZAAAADcAAAABAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAGlyOIRNnS6HDEkmGAE9gpZJUnLZNnYsjzt+pXVxR/9QAAAAAAAAAAAX14QAAAAAAAAAAAVxR/9QAAABAK6pcXYMzAEmH08CZ1LWmvtNDKauhx+OImtP/Lk4hVTMJRVBOebVs5WEPj9iSrgGT0EswuDCZ2i5AEzwgGof9Ag==",
			resultXDR:     "AAAAAAAAAGQAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAA=",
			metaXDR:       "AAAAAQAAAAIAAAADAAAAOAAAAAAAAAAAGlyOIRNnS6HDEkmGAE9gpZJUnLZNnYsjzt+pXVxR/9QAAAACVAvjnAAAADcAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAABAAAAOAAAAAAAAAAAGlyOIRNnS6HDEkmGAE9gpZJUnLZNnYsjzt+pXVxR/9QAAAACVAvjnAAAADcAAAABAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAABAAAAAA==",
			feeChangesXDR: "AAAAAgAAAAMAAAA3AAAAAAAAAAAaXI4hE2dLocMSSYYAT2ClklSctk2diyPO36ldXFH/1AAAAAJUC+QAAAAANwAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAEAAAA4AAAAAAAAAAAaXI4hE2dLocMSSYYAT2ClklSctk2diyPO36ldXFH/1AAAAAJUC+OcAAAANwAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA==",
			hash:          "2a805712c6d10f9e74bb0ccf54ae92a2b4b1e586451fe8133a2433816f6b567c",
			index:         0,
			expected: map[string]interface{}{
				"amount":     "10.0000000",
				"asset_type": "native",
				"from":       "GANFZDRBCNTUXIODCJEYMACPMCSZEVE4WZGZ3CZDZ3P2SXK4KH75IK6Y",
				"to":         "GANFZDRBCNTUXIODCJEYMACPMCSZEVE4WZGZ3CZDZ3P2SXK4KH75IK6Y",
			},
		},
		{
			desc:          "pathPaymentStrictReceive",
			envelopeXDR:   "AAAAAONt/6wGI884Zi6sYDYC1GOV/drnh4OcRrTrqJPoOTUKAAAAZAAAABAAAAADAAAAAAAAAAAAAAABAAAAAAAAAAIAAAAAAAAAADuaygAAAAAABAjoBMEUiZNLUjsWXL1iK59D90Li4w56076b8HKxZfIAAAABRVVSAAAAAAAuwvNzNk9twbuJHUBqnX26GYI3MbCdpQU9t4n6EVRXsQAAAAA7msoAAAAAAAAAAAAAAAAB6Dk1CgAAAEB+7jxesBKKrF343onyycjp2tiQLZiGH2ETl+9fuOqotveY2rIgvt9ng+QJ2aDP3+PnDsYEa9ZUaA+Zne2nIGgE",
			resultXDR:     "AAAAAAAAAGQAAAAAAAAAAQAAAAAAAAACAAAAAAAAAAEAAAAALsLzczZPbcG7iR1Aap19uhmCNzGwnaUFPbeJ+hFUV7EAAAAAAAAAAgAAAAFFVVIAAAAAAC7C83M2T23Bu4kdQGqdfboZgjcxsJ2lBT23ifoRVFexAAAAADuaygAAAAAAAAAAADuaygAAAAAABAjoBMEUiZNLUjsWXL1iK59D90Li4w56076b8HKxZfIAAAABRVVSAAAAAAAuwvNzNk9twbuJHUBqnX26GYI3MbCdpQU9t4n6EVRXsQAAAAA7msoAAAAAAA==",
			metaXDR:       "AAAAAQAAAAIAAAADAAAAFAAAAAAAAAAA423/rAYjzzhmLqxgNgLUY5X92ueHg5xGtOuok+g5NQoAAAACVAvi1AAAABAAAAACAAAAAQAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAABAAAAFAAAAAAAAAAA423/rAYjzzhmLqxgNgLUY5X92ueHg5xGtOuok+g5NQoAAAACVAvi1AAAABAAAAADAAAAAQAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAABAAAACAAAAAMAAAATAAAAAQAAAAAECOgEwRSJk0tSOxZcvWIrn0P3QuLjDnrTvpvwcrFl8gAAAAFFVVIAAAAAAC7C83M2T23Bu4kdQGqdfboZgjcxsJ2lBT23ifoRVFexAAAAAHc1lAB//////////wAAAAEAAAAAAAAAAAAAAAEAAAAUAAAAAQAAAAAECOgEwRSJk0tSOxZcvWIrn0P3QuLjDnrTvpvwcrFl8gAAAAFFVVIAAAAAAC7C83M2T23Bu4kdQGqdfboZgjcxsJ2lBT23ifoRVFexAAAAALLQXgB//////////wAAAAEAAAAAAAAAAAAAAAMAAAATAAAAAgAAAAAuwvNzNk9twbuJHUBqnX26GYI3MbCdpQU9t4n6EVRXsQAAAAAAAAACAAAAAUVVUgAAAAAALsLzczZPbcG7iR1Aap19uhmCNzGwnaUFPbeJ+hFUV7EAAAAAAAAAADuaygAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAIAAAACAAAAAC7C83M2T23Bu4kdQGqdfboZgjcxsJ2lBT23ifoRVFexAAAAAAAAAAIAAAADAAAAFAAAAAAAAAAA423/rAYjzzhmLqxgNgLUY5X92ueHg5xGtOuok+g5NQoAAAACVAvi1AAAABAAAAADAAAAAQAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAABAAAAFAAAAAAAAAAA423/rAYjzzhmLqxgNgLUY5X92ueHg5xGtOuok+g5NQoAAAACGHEY1AAAABAAAAADAAAAAQAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAADAAAAEwAAAAAAAAAALsLzczZPbcG7iR1Aap19uhmCNzGwnaUFPbeJ+hFUV7EAAAACVAvi1AAAABAAAAADAAAAAgAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAQAAAAA7msoAAAAAAHc1lAAAAAAAAAAAAAAAAAEAAAAUAAAAAAAAAAAuwvNzNk9twbuJHUBqnX26GYI3MbCdpQU9t4n6EVRXsQAAAAKPpqzUAAAAEAAAAAMAAAABAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAABAAAAAAAAAAAAAAAAdzWUAAAAAAAAAAAA",
			feeChangesXDR: "AAAAAgAAAAMAAAATAAAAAAAAAADjbf+sBiPPOGYurGA2AtRjlf3a54eDnEa066iT6Dk1CgAAAAJUC+M4AAAAEAAAAAIAAAABAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAEAAAAUAAAAAAAAAADjbf+sBiPPOGYurGA2AtRjlf3a54eDnEa066iT6Dk1CgAAAAJUC+LUAAAAEAAAAAIAAAABAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA==",
			hash:          "96415ac1d2f79621b26b1568f963fd8dd6c50c20a22c7428cefbfe9dee867588",
			index:         0,
			expected: map[string]interface{}{
				"to":                "GACAR2AEYEKITE2LKI5RMXF5MIVZ6Q7XILROGDT22O7JX4DSWFS7FDDP",
				"from":              "GDRW375MAYR46ODGF2WGANQC2RRZL7O246DYHHCGWTV2RE7IHE2QUQLD",
				"path":              []map[string]interface{}{},
				"amount":            "100.0000000",
				"asset_code":        "EUR",
				"asset_type":        "credit_alphanum4",
				"source_max":        "100.0000000",
				"asset_issuer":      "GAXMF43TGZHW3QN3REOUA2U5PW5BTARXGGYJ3JIFHW3YT6QRKRL3CPPU",
				"source_amount":     "100.0000000",
				"source_asset_type": "native",
			},
		},
		{
			desc:          "manageSellOffer",
			envelopeXDR:   "AAAAAC7C83M2T23Bu4kdQGqdfboZgjcxsJ2lBT23ifoRVFexAAAAZAAAABAAAAACAAAAAAAAAAAAAAABAAAAAAAAAAMAAAAAAAAAAVVTRAAAAAAALsLzczZPbcG7iR1Aap19uhmCNzGwnaUFPbeJ+hFUV7EAAAAA7msoAAAAAAEAAAACAAAAAAAAAAAAAAAAAAAAARFUV7EAAABALuai5QxceFbtAiC5nkntNVnvSPeWR+C+FgplPAdRgRS+PPESpUiSCyuiwuhmvuDw7kwxn+A6E0M4ca1s2qzMAg==",
			resultXDR:     "AAAAAAAAAGQAAAAAAAAAAQAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAC7C83M2T23Bu4kdQGqdfboZgjcxsJ2lBT23ifoRVFexAAAAAAAAAAEAAAAAAAAAAVVTRAAAAAAALsLzczZPbcG7iR1Aap19uhmCNzGwnaUFPbeJ+hFUV7EAAAAA7msoAAAAAAEAAAACAAAAAAAAAAAAAAAA",
			metaXDR:       "AAAAAQAAAAIAAAADAAAAEgAAAAAAAAAALsLzczZPbcG7iR1Aap19uhmCNzGwnaUFPbeJ+hFUV7EAAAACVAvi1AAAABAAAAABAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAABAAAAEgAAAAAAAAAALsLzczZPbcG7iR1Aap19uhmCNzGwnaUFPbeJ+hFUV7EAAAACVAvi1AAAABAAAAACAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAABAAAAAwAAAAMAAAASAAAAAAAAAAAuwvNzNk9twbuJHUBqnX26GYI3MbCdpQU9t4n6EVRXsQAAAAJUC+LUAAAAEAAAAAIAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAEAAAASAAAAAAAAAAAuwvNzNk9twbuJHUBqnX26GYI3MbCdpQU9t4n6EVRXsQAAAAJUC+LUAAAAEAAAAAIAAAABAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAABAAAAAAAAAAAAAAAA7msoAAAAAAAAAAAAAAAAAAAAABIAAAACAAAAAC7C83M2T23Bu4kdQGqdfboZgjcxsJ2lBT23ifoRVFexAAAAAAAAAAEAAAAAAAAAAVVTRAAAAAAALsLzczZPbcG7iR1Aap19uhmCNzGwnaUFPbeJ+hFUV7EAAAAA7msoAAAAAAEAAAACAAAAAAAAAAAAAAAA",
			feeChangesXDR: "AAAAAgAAAAMAAAASAAAAAAAAAAAuwvNzNk9twbuJHUBqnX26GYI3MbCdpQU9t4n6EVRXsQAAAAJUC+OcAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAEAAAASAAAAAAAAAAAuwvNzNk9twbuJHUBqnX26GYI3MbCdpQU9t4n6EVRXsQAAAAJUC+M4AAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA==",
			hash:          "ca756d1519ceda79f8722042b12cea7ba004c3bd961adb62b59f88a867f86eb3",
			index:         0,
			expected: map[string]interface{}{
				"amount":              "400.0000000",
				"buying_asset_code":   "USD",
				"buying_asset_issuer": "GAXMF43TGZHW3QN3REOUA2U5PW5BTARXGGYJ3JIFHW3YT6QRKRL3CPPU",
				"buying_asset_type":   "credit_alphanum4",
				"offer_id":            xdr.Int64(0),
				"price":               "0.5000000",
				"price_r": map[string]interface{}{
					"d": xdr.Int32(2),
					"n": xdr.Int32(1),
				},
				"selling_asset_type": "native",
			},
		},
		{
			desc:          "createPassiveSellOffer",
			envelopeXDR:   "AAAAAHxm7WmlvJxH5BuTz9Qn+PnWcTY9zK8s6YgIjqQyboYYAAAAZAAAABkAAAABAAAAAAAAAAAAAAABAAAAAAAAAAQAAAABVVNEAAAAAAB8Zu1ppbycR+Qbk8/UJ/j51nE2PcyvLOmICI6kMm6GGAAAAAAAAAAAdzWUAAAAAAEAAAABAAAAAAAAAAEyboYYAAAAQBqzCYDuLYn/jXhfEVxEGigMCJGoOBCK92lUb3Um15PgwSJ63tNl+FpH8+y5c+mCs/rzcvdyo9uXdodd4LXWiQg=",
			resultXDR:     "AAAAAAAAAGQAAAAAAAAAAQAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAHxm7WmlvJxH5BuTz9Qn+PnWcTY9zK8s6YgIjqQyboYYAAAAAAAAAAUAAAABVVNEAAAAAAB8Zu1ppbycR+Qbk8/UJ/j51nE2PcyvLOmICI6kMm6GGAAAAAAAAAAAdzWUAAAAAAEAAAABAAAAAQAAAAAAAAAA",
			metaXDR:       "AAAAAQAAAAIAAAADAAAAGgAAAAAAAAAAfGbtaaW8nEfkG5PP1Cf4+dZxNj3MryzpiAiOpDJuhhgAAAACVAvjOAAAABkAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAABAAAAGgAAAAAAAAAAfGbtaaW8nEfkG5PP1Cf4+dZxNj3MryzpiAiOpDJuhhgAAAACVAvjOAAAABkAAAABAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAABAAAAAwAAAAMAAAAaAAAAAAAAAAB8Zu1ppbycR+Qbk8/UJ/j51nE2PcyvLOmICI6kMm6GGAAAAAJUC+M4AAAAGQAAAAEAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAEAAAAaAAAAAAAAAAB8Zu1ppbycR+Qbk8/UJ/j51nE2PcyvLOmICI6kMm6GGAAAAAJUC+M4AAAAGQAAAAEAAAABAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAABAAAAAHc1lAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABoAAAACAAAAAHxm7WmlvJxH5BuTz9Qn+PnWcTY9zK8s6YgIjqQyboYYAAAAAAAAAAUAAAABVVNEAAAAAAB8Zu1ppbycR+Qbk8/UJ/j51nE2PcyvLOmICI6kMm6GGAAAAAAAAAAAdzWUAAAAAAEAAAABAAAAAQAAAAAAAAAA",
			feeChangesXDR: "AAAAAgAAAAMAAAAZAAAAAAAAAAB8Zu1ppbycR+Qbk8/UJ/j51nE2PcyvLOmICI6kMm6GGAAAAAJUC+QAAAAAGQAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAEAAAAaAAAAAAAAAAB8Zu1ppbycR+Qbk8/UJ/j51nE2PcyvLOmICI6kMm6GGAAAAAJUC+OcAAAAGQAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA==",
			hash:          "a76e0260f6b83c6ea93f545d17de721c079dc31e81ee5edc41f159ec5fb48443",
			index:         0,
			expected: map[string]interface{}{
				"price":  "1.0000000",
				"amount": "200.0000000",
				"price_r": map[string]interface{}{
					"d": xdr.Int32(1),
					"n": xdr.Int32(1),
				},
				"buying_asset_type":    "native",
				"selling_asset_code":   "USD",
				"selling_asset_type":   "credit_alphanum4",
				"selling_asset_issuer": "GB6GN3LJUW6JYR7EDOJ47VBH7D45M4JWHXGK6LHJRAEI5JBSN2DBQY7Q",
			},
		},
		{
			desc:          "setOption -  home domain",
			envelopeXDR:   "AAAAAJBSxgo7D+SP4ldcjl6iwJjYtL5+AfTMUdled6cwnjBQAAAAZAAAABsAAAAGAAAAAAAAAAAAAAABAAAAAAAAAAUAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAC2V4YW1wbGUuY29tAAAAAAAAAAAAAAAAATCeMFAAAABAkID6CkBHP9eovLQXkMQJ7QkE6NWlmdKGmLxaiI1YaVKZaKJxz5P85x+6wzpYxxbs6Bd2l4qxVjS7Q36DwRiqBA==",
			resultXDR:     "AAAAAAAAAGQAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAA=",
			metaXDR:       "AAAAAQAAAAIAAAADAAAAHAAAAAAAAAAAkFLGCjsP5I/iV1yOXqLAmNi0vn4B9MxR2V53pzCeMFAAAAACVAvhRAAAABsAAAAFAAAAAAAAAAEAAAAAYvwdC9CRsrYcDdZWNGsqaNfTR8bywsjubQRHAlb8BfcAAAADAAAAAAIAAgIAAAAAAAAAAAAAAAAAAAABAAAAHAAAAAAAAAAAkFLGCjsP5I/iV1yOXqLAmNi0vn4B9MxR2V53pzCeMFAAAAACVAvhRAAAABsAAAAGAAAAAAAAAAEAAAAAYvwdC9CRsrYcDdZWNGsqaNfTR8bywsjubQRHAlb8BfcAAAADAAAAAAIAAgIAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAMAAAAcAAAAAAAAAACQUsYKOw/kj+JXXI5eosCY2LS+fgH0zFHZXnenMJ4wUAAAAAJUC+FEAAAAGwAAAAYAAAAAAAAAAQAAAABi/B0L0JGythwN1lY0aypo19NHxvLCyO5tBEcCVvwF9wAAAAMAAAAAAgACAgAAAAAAAAAAAAAAAAAAAAEAAAAcAAAAAAAAAACQUsYKOw/kj+JXXI5eosCY2LS+fgH0zFHZXnenMJ4wUAAAAAJUC+FEAAAAGwAAAAYAAAAAAAAAAQAAAABi/B0L0JGythwN1lY0aypo19NHxvLCyO5tBEcCVvwF9wAAAAMAAAALZXhhbXBsZS5jb20AAgACAgAAAAAAAAAAAAAAAA==",
			feeChangesXDR: "AAAAAgAAAAMAAAAcAAAAAAAAAACQUsYKOw/kj+JXXI5eosCY2LS+fgH0zFHZXnenMJ4wUAAAAAJUC+IMAAAAGwAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAEAAAAcAAAAAAAAAACQUsYKOw/kj+JXXI5eosCY2LS+fgH0zFHZXnenMJ4wUAAAAAJUC+GoAAAAGwAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA==",
			hash:          "8ccc0c28c3e99a63cc59bad7dec3f5c56eb3942c548ecd40bc39c509d6b081d4",
			index:         0,
			expected: map[string]interface{}{
				"home_domain": xdr.String32("example.com"),
			},
		},
		{
			desc:          "setOption - signer",
			envelopeXDR:   "AAAAAJBSxgo7D+SP4ldcjl6iwJjYtL5+AfTMUdled6cwnjBQAAAAZAAAABsAAAAMAAAAAAAAAAAAAAABAAAAAAAAAAUAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAB8ndnLViBPKqPJAcSNhZzc2mH7fQ7RtzGyFA8mFkMTkAAAAAAAAAAAAAAAATCeMFAAAABAOb0qGWnk1WrSUXS6iQFocaIOY/BDmgG1zTmlPyg0boSid3jTBK3z9U8+IPGAOELNLgkQHtgGYFgFGMio1xY+BQ==",
			resultXDR:     "AAAAAAAAAGQAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAA=",
			metaXDR:       "AAAAAQAAAAIAAAADAAAAIAAAAAAAAAAAkFLGCjsP5I/iV1yOXqLAmNi0vn4B9MxR2V53pzCeMFAAAAACVAvfUAAAABsAAAALAAAAAQAAAAEAAAAAYvwdC9CRsrYcDdZWNGsqaNfTR8bywsjubQRHAlb8BfcAAAAAAAAAC2V4YW1wbGUuY29tAAIAAgIAAAABAAAAAHyd2ctWIE8qo8kBxI2FnNzaYft9DtG3MbIUDyYWQxOQAAAABQAAAAAAAAAAAAAAAQAAACAAAAAAAAAAAJBSxgo7D+SP4ldcjl6iwJjYtL5+AfTMUdled6cwnjBQAAAAAlQL31AAAAAbAAAADAAAAAEAAAABAAAAAGL8HQvQkbK2HA3WVjRrKmjX00fG8sLI7m0ERwJW/AX3AAAAAAAAAAtleGFtcGxlLmNvbQACAAICAAAAAQAAAAB8ndnLViBPKqPJAcSNhZzc2mH7fQ7RtzGyFA8mFkMTkAAAAAUAAAAAAAAAAAAAAAEAAAACAAAAAwAAACAAAAAAAAAAAJBSxgo7D+SP4ldcjl6iwJjYtL5+AfTMUdled6cwnjBQAAAAAlQL31AAAAAbAAAADAAAAAEAAAABAAAAAGL8HQvQkbK2HA3WVjRrKmjX00fG8sLI7m0ERwJW/AX3AAAAAAAAAAtleGFtcGxlLmNvbQACAAICAAAAAQAAAAB8ndnLViBPKqPJAcSNhZzc2mH7fQ7RtzGyFA8mFkMTkAAAAAUAAAAAAAAAAAAAAAEAAAAgAAAAAAAAAACQUsYKOw/kj+JXXI5eosCY2LS+fgH0zFHZXnenMJ4wUAAAAAJUC99QAAAAGwAAAAwAAAAAAAAAAQAAAABi/B0L0JGythwN1lY0aypo19NHxvLCyO5tBEcCVvwF9wAAAAAAAAALZXhhbXBsZS5jb20AAgACAgAAAAAAAAAAAAAAAA==",
			feeChangesXDR: "AAAAAgAAAAMAAAAgAAAAAAAAAACQUsYKOw/kj+JXXI5eosCY2LS+fgH0zFHZXnenMJ4wUAAAAAJUC9+0AAAAGwAAAAoAAAABAAAAAQAAAABi/B0L0JGythwN1lY0aypo19NHxvLCyO5tBEcCVvwF9wAAAAMAAAALZXhhbXBsZS5jb20AAgACAgAAAAEAAAAAfJ3Zy1YgTyqjyQHEjYWc3Nph+30O0bcxshQPJhZDE5AAAAAFAAAAAAAAAAAAAAABAAAAIAAAAAAAAAAAkFLGCjsP5I/iV1yOXqLAmNi0vn4B9MxR2V53pzCeMFAAAAACVAvfUAAAABsAAAAKAAAAAQAAAAEAAAAAYvwdC9CRsrYcDdZWNGsqaNfTR8bywsjubQRHAlb8BfcAAAADAAAAC2V4YW1wbGUuY29tAAIAAgIAAAABAAAAAHyd2ctWIE8qo8kBxI2FnNzaYft9DtG3MbIUDyYWQxOQAAAABQAAAAAAAAAA",
			hash:          "6b38cdd5c17df2013d5a5e211c4b32218b6be91025316b1aab28bc12316615d5",
			index:         0,
			expected: map[string]interface{}{
				"signer_key":    "GB6J3WOLKYQE6KVDZEA4JDMFTTONUYP3PUHNDNZRWIKA6JQWIMJZATFE",
				"signer_weight": xdr.Uint32(0),
			},
		},
		{
			desc:          "setOption - inflation dest",
			envelopeXDR:   "AAAAAOPd2ARCnU3lTd8FI4LH+evle2IKY0nagwlkzH4xgrcnAAAAZAAAAC0AAAABAAAAAAAAAAAAAAABAAAAAAAAAAUAAAABAAAAAOPd2ARCnU3lTd8FI4LH+evle2IKY0nagwlkzH4xgrcnAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABMYK3JwAAAEAOkGOPTOBDSQ7nW2Zn+bls2PDUebk2/k3/gqHKQ8eYOFsD6nBeEvyMD858vo5BabjQwB9injABIM8esDh7bEkC",
			resultXDR:     "AAAAAAAAAGQAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAA=",
			metaXDR:       "AAAAAQAAAAIAAAADAAAALgAAAAAAAAAA493YBEKdTeVN3wUjgsf56+V7YgpjSdqDCWTMfjGCtycCxorwuxP/nAAAAC0AAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAABAAAALgAAAAAAAAAA493YBEKdTeVN3wUjgsf56+V7YgpjSdqDCWTMfjGCtycCxorwuxP/nAAAAC0AAAABAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAMAAAAuAAAAAAAAAADj3dgEQp1N5U3fBSOCx/nr5XtiCmNJ2oMJZMx+MYK3JwLGivC7E/+cAAAALQAAAAEAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAEAAAAuAAAAAAAAAADj3dgEQp1N5U3fBSOCx/nr5XtiCmNJ2oMJZMx+MYK3JwLGivC7E/+cAAAALQAAAAEAAAAAAAAAAQAAAADj3dgEQp1N5U3fBSOCx/nr5XtiCmNJ2oMJZMx+MYK3JwAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA==",
			feeChangesXDR: "AAAAAgAAAAMAAAAtAAAAAAAAAADj3dgEQp1N5U3fBSOCx/nr5XtiCmNJ2oMJZMx+MYK3JwLGivC7FAAAAAAALQAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAEAAAAuAAAAAAAAAADj3dgEQp1N5U3fBSOCx/nr5XtiCmNJ2oMJZMx+MYK3JwLGivC7E/+cAAAALQAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA==",
			hash:          "7207de5b75243e0b062c3833f587036b7e9f64453be49ff50f3f3fdc7516ec6b",
			index:         0,
			expected: map[string]interface{}{
				"inflation_dest": "GDR53WAEIKOU3ZKN34CSHAWH7HV6K63CBJRUTWUDBFSMY7RRQK3SPKOS",
			},
		},
		{
			desc:          "setOption - set flags (all)",
			envelopeXDR:   "AAAAAOfbN5h8zjMqvileFVS66GUvvu5mbAKtbhD+buOEj6BzAAAAZAAGVyQAAAABAAAAAQAAAAAAAAAAAAAAAF3b7rYAAAAAAAAAAQAAAAAAAAAFAAAAAAAAAAAAAAABAAAABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABhI+gcwAAAEAZ5WOkuymbGA/kmUxoKzpdc5Hupy6xgVDA2uzckBXDaPLieH9AMXi9c8ptXDBVBopJQy+31VA63yiR6+b2mOQH",
			resultXDR:     "AAAAAAAAAGQAAAAAAAAAAQAAAAAAAAAFAAAAAAAAAAA=",
			metaXDR:       "AAAAAQAAAAIAAAADAAZXJQAAAAAAAAAA59s3mHzOMyq+KV4VVLroZS++7mZsAq1uEP5u44SPoHMAAAAAATEsnAAGVyQAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAABAAZXJQAAAAAAAAAA59s3mHzOMyq+KV4VVLroZS++7mZsAq1uEP5u44SPoHMAAAAAATEsnAAGVyQAAAABAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAMABlclAAAAAAAAAADn2zeYfM4zKr4pXhVUuuhlL77uZmwCrW4Q/m7jhI+gcwAAAAABMSycAAZXJAAAAAEAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAEABlclAAAAAAAAAADn2zeYfM4zKr4pXhVUuuhlL77uZmwCrW4Q/m7jhI+gcwAAAAABMSycAAZXJAAAAAEAAAAAAAAAAAAAAAcAAAAAAQAAAAAAAAAAAAAAAAAAAA==",
			feeChangesXDR: "AAAAAgAAAAMABlckAAAAAAAAAADn2zeYfM4zKr4pXhVUuuhlL77uZmwCrW4Q/m7jhI+gcwAAAAABMS0AAAZXJAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAEABlclAAAAAAAAAADn2zeYfM4zKr4pXhVUuuhlL77uZmwCrW4Q/m7jhI+gcwAAAAABMSycAAZXJAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA==",
			hash:          "2c11336f2b87b149eb4c49a7c8693281450761e140c321929da9987709f6f0d3",
			index:         0,
			expected: map[string]interface{}{
				"set_flags": []int32{1, 2, 4},
				"set_flags_s": []string{
					"auth_required",
					"auth_revocable",
					"auth_immutable",
				},
			},
		},
		{
			desc:          "setOption - set flags (auth required)",
			envelopeXDR:   "AAAAAJBSxgo7D+SP4ldcjl6iwJjYtL5+AfTMUdled6cwnjBQAAAAZAAAABsAAAACAAAAAAAAAAAAAAABAAAAAAAAAAUAAAAAAAAAAQAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABMJ4wUAAAAEDYxq3zpaFIC2JcuJUbrQ3MFXzqvu+5G7XUi4NnHlfbLutn76ylQcjuwLgbUG2lqcQfl75doPUZyurKtFP1rkMO",
			resultXDR:     "AAAAAAAAAGQAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAA=",
			metaXDR:       "AAAAAQAAAAIAAAADAAAAHAAAAAAAAAAAkFLGCjsP5I/iV1yOXqLAmNi0vn4B9MxR2V53pzCeMFAAAAACVAvhRAAAABsAAAABAAAAAAAAAAEAAAAAYvwdC9CRsrYcDdZWNGsqaNfTR8bywsjubQRHAlb8BfcAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAABAAAAHAAAAAAAAAAAkFLGCjsP5I/iV1yOXqLAmNi0vn4B9MxR2V53pzCeMFAAAAACVAvhRAAAABsAAAACAAAAAAAAAAEAAAAAYvwdC9CRsrYcDdZWNGsqaNfTR8bywsjubQRHAlb8BfcAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAMAAAAcAAAAAAAAAACQUsYKOw/kj+JXXI5eosCY2LS+fgH0zFHZXnenMJ4wUAAAAAJUC+FEAAAAGwAAAAIAAAAAAAAAAQAAAABi/B0L0JGythwN1lY0aypo19NHxvLCyO5tBEcCVvwF9wAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAEAAAAcAAAAAAAAAACQUsYKOw/kj+JXXI5eosCY2LS+fgH0zFHZXnenMJ4wUAAAAAJUC+FEAAAAGwAAAAIAAAAAAAAAAQAAAABi/B0L0JGythwN1lY0aypo19NHxvLCyO5tBEcCVvwF9wAAAAEAAAAAAQAAAAAAAAAAAAAAAAAAAA==",
			feeChangesXDR: "AAAAAgAAAAMAAAAcAAAAAAAAAACQUsYKOw/kj+JXXI5eosCY2LS+fgH0zFHZXnenMJ4wUAAAAAJUC+OcAAAAGwAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAEAAAAcAAAAAAAAAACQUsYKOw/kj+JXXI5eosCY2LS+fgH0zFHZXnenMJ4wUAAAAAJUC+M4AAAAGwAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA==",
			hash:          "345ef7f85c6ea297e3f994feef279b63812628681bd173a1f615185a4368e482",
			index:         0,
			expected: map[string]interface{}{
				"set_flags": []int32{1},
				"set_flags_s": []string{
					"auth_required",
				},
			},
		},
		{
			desc:          "setOption - set flags (auth  revocable)",
			envelopeXDR:   "AAAAAJBSxgo7D+SP4ldcjl6iwJjYtL5+AfTMUdled6cwnjBQAAAAZAAAABsAAAADAAAAAAAAAAAAAAABAAAAAAAAAAUAAAAAAAAAAQAAAAAAAAABAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABMJ4wUAAAAEAKuQ1exMu8hdf8dOPeULX2DG7DZx5WWIUFHXJMWGG9KmVrQoZDt2S6a/1uYEVJnvvY/EoJM5RpVjh2ZCs30VYA",
			resultXDR:     "AAAAAAAAAGQAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAA=",
			metaXDR:       "AAAAAQAAAAIAAAADAAAAHAAAAAAAAAAAkFLGCjsP5I/iV1yOXqLAmNi0vn4B9MxR2V53pzCeMFAAAAACVAvhRAAAABsAAAACAAAAAAAAAAEAAAAAYvwdC9CRsrYcDdZWNGsqaNfTR8bywsjubQRHAlb8BfcAAAABAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAABAAAAHAAAAAAAAAAAkFLGCjsP5I/iV1yOXqLAmNi0vn4B9MxR2V53pzCeMFAAAAACVAvhRAAAABsAAAADAAAAAAAAAAEAAAAAYvwdC9CRsrYcDdZWNGsqaNfTR8bywsjubQRHAlb8BfcAAAABAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAMAAAAcAAAAAAAAAACQUsYKOw/kj+JXXI5eosCY2LS+fgH0zFHZXnenMJ4wUAAAAAJUC+FEAAAAGwAAAAMAAAAAAAAAAQAAAABi/B0L0JGythwN1lY0aypo19NHxvLCyO5tBEcCVvwF9wAAAAEAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAEAAAAcAAAAAAAAAACQUsYKOw/kj+JXXI5eosCY2LS+fgH0zFHZXnenMJ4wUAAAAAJUC+FEAAAAGwAAAAMAAAAAAAAAAQAAAABi/B0L0JGythwN1lY0aypo19NHxvLCyO5tBEcCVvwF9wAAAAMAAAAAAQAAAAAAAAAAAAAAAAAAAA==",
			feeChangesXDR: "AAAAAgAAAAMAAAAcAAAAAAAAAACQUsYKOw/kj+JXXI5eosCY2LS+fgH0zFHZXnenMJ4wUAAAAAJUC+M4AAAAGwAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAEAAAAcAAAAAAAAAACQUsYKOw/kj+JXXI5eosCY2LS+fgH0zFHZXnenMJ4wUAAAAAJUC+LUAAAAGwAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA==",
			hash:          "2a14735d7b05109359444acdd87e7fe92c98e9295d2ba61b05e25d1f7ee10fd3",
			index:         0,
			expected: map[string]interface{}{
				"set_flags": []int32{2},
				"set_flags_s": []string{
					"auth_revocable",
				},
			},
		},
		{
			desc:          "setOption - set flags (auth  immutable)",
			envelopeXDR:   "AAAAAOZPoQTlXBixd6XSUExX/Yvos/pVllkUNdNvCdmC+mNkAAACvAAE5bIAAAAOAAAAAQAAAAAAAAAAAAAAAF3X8mwAAAAAAAAABwAAAAEAAAAA5k+hBOVcGLF3pdJQTFf9i+iz+lWWWRQ1028J2YL6Y2QAAAAAAAAAAPEmrGI5+i9IbPyf3l+6kVhML1lUZJJmyQvdBRccfZkgAAAAAACYloAAAAABAAAAAOZPoQTlXBixd6XSUExX/Yvos/pVllkUNdNvCdmC+mNkAAAAAAAAAAD66ofFUOv3/k5PaB0F6wr5c0jvwdDY933ssbjK656DmwAAAAAF9eEAAAAAAQAAAAD66ofFUOv3/k5PaB0F6wr5c0jvwdDY933ssbjK656DmwAAAAYAAAABVFNUAAAAAADxJqxiOfovSGz8n95fupFYTC9ZVGSSZskL3QUXHH2ZIAAAAAB3NZQAAAAAAQAAAADxJqxiOfovSGz8n95fupFYTC9ZVGSSZskL3QUXHH2ZIAAAAAEAAAAA+uqHxVDr9/5OT2gdBesK+XNI78HQ2Pd97LG4yuueg5sAAAABVFNUAAAAAADxJqxiOfovSGz8n95fupFYTC9ZVGSSZskL3QUXHH2ZIAAAAAB3NZQAAAAAAQAAAADxJqxiOfovSGz8n95fupFYTC9ZVGSSZskL3QUXHH2ZIAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAABF0c3QudGVzdGFzc2V0LmNvbQAAAAAAAAAAAAABAAAAAPEmrGI5+i9IbPyf3l+6kVhML1lUZJJmyQvdBRccfZkgAAAABQAAAAAAAAAAAAAAAQAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAPEmrGI5+i9IbPyf3l+6kVhML1lUZJJmyQvdBRccfZkgAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4L6Y2QAAABAd8d0e8OiMmmGlxLrPu8JfTLphUfFPgx0Fs/fwU6/ilzwbpTHCKICWGlSz8enjb57FXD6DliXcaWJeR/2Fj8tB+ueg5sAAABAkAwqpu1liQpxh3C2MdsDoOg/N4pxuUuzh0Ey/0g0QbWy0Y2bBkLPldsGj/pDNbKfkZPGfdx4MZ6rHbUdGEwgDRx9mSAAAABA/IRS0D7EcFS1J6uR4HnOvh8tikBhVe+0uI6DPkqv/GfSqeuoZIRyWxKSd/v64DxxozKZsmQmatLZqOnQwkuxCA==",
			resultXDR:     "AAAAAAAAArwAAAAAAAAABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAAAAAAAAA=",
			metaXDR:       "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",
			feeChangesXDR: "AAAAAgAAAAMABZv0AAAAAAAAAADmT6EE5VwYsXel0lBMV/2L6LP6VZZZFDXTbwnZgvpjZAAAABbjItzUAATlsgAAAA0AAAAAAAAAAAAAAAEAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAEABZwAAAAAAAAAAADmT6EE5VwYsXel0lBMV/2L6LP6VZZZFDXTbwnZgvpjZAAAABbjItoYAATlsgAAAA0AAAAAAAAAAAAAAAEAAAAAAQAAAAAAAAAAAAAAAAAAAA==",
			hash:          "12e901c3c12cc9f35adc09e83c0a2d58f939e8c0bebc6f9a945aea42f2587cfe",
			index:         5,
			expected: map[string]interface{}{
				"set_flags": []int32{4},
				"set_flags_s": []string{
					"auth_immutable",
				},
			},
		},
		{
			desc:          "setOption - master weight",
			envelopeXDR:   "AAAAAJBSxgo7D+SP4ldcjl6iwJjYtL5+AfTMUdled6cwnjBQAAAAZAAAABsAAAAEAAAAAAAAAAAAAAABAAAAAAAAAAUAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAEAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATCeMFAAAABAAd6MzHDjUdRtHozzDnD3jJA+uRDCar3PQtuH/43pnROzk1HkovJPQ1YyzcpOb/NeuU/LKNzseL0PJNasVX1lAQ==",
			resultXDR:     "AAAAAAAAAGQAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAA=",
			metaXDR:       "AAAAAQAAAAIAAAADAAAAHAAAAAAAAAAAkFLGCjsP5I/iV1yOXqLAmNi0vn4B9MxR2V53pzCeMFAAAAACVAvhRAAAABsAAAADAAAAAAAAAAEAAAAAYvwdC9CRsrYcDdZWNGsqaNfTR8bywsjubQRHAlb8BfcAAAADAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAABAAAAHAAAAAAAAAAAkFLGCjsP5I/iV1yOXqLAmNi0vn4B9MxR2V53pzCeMFAAAAACVAvhRAAAABsAAAAEAAAAAAAAAAEAAAAAYvwdC9CRsrYcDdZWNGsqaNfTR8bywsjubQRHAlb8BfcAAAADAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAMAAAAcAAAAAAAAAACQUsYKOw/kj+JXXI5eosCY2LS+fgH0zFHZXnenMJ4wUAAAAAJUC+FEAAAAGwAAAAQAAAAAAAAAAQAAAABi/B0L0JGythwN1lY0aypo19NHxvLCyO5tBEcCVvwF9wAAAAMAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAEAAAAcAAAAAAAAAACQUsYKOw/kj+JXXI5eosCY2LS+fgH0zFHZXnenMJ4wUAAAAAJUC+FEAAAAGwAAAAQAAAAAAAAAAQAAAABi/B0L0JGythwN1lY0aypo19NHxvLCyO5tBEcCVvwF9wAAAAMAAAAAAgAAAAAAAAAAAAAAAAAAAA==",
			feeChangesXDR: "AAAAAgAAAAMAAAAcAAAAAAAAAACQUsYKOw/kj+JXXI5eosCY2LS+fgH0zFHZXnenMJ4wUAAAAAJUC+LUAAAAGwAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAEAAAAcAAAAAAAAAACQUsYKOw/kj+JXXI5eosCY2LS+fgH0zFHZXnenMJ4wUAAAAAJUC+JwAAAAGwAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA==",
			hash:          "4f9598206ab17cf27b5c3eb9e906d63ebee2626654112eabdd2bce7bf12cccf2",
			index:         0,
			expected: map[string]interface{}{
				"master_key_weight": xdr.Uint32(2),
			},
		},
		{
			desc:          "setOption - thresholds (medium, high)",
			envelopeXDR:   "AAAAAJBSxgo7D+SP4ldcjl6iwJjYtL5+AfTMUdled6cwnjBQAAAAZAAAABsAAAAFAAAAAAAAAAAAAAABAAAAAAAAAAUAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAABAAAAAAAAAAEAAAACAAAAAQAAAAIAAAAAAAAAAAAAAAAAAAABMJ4wUAAAAEAnFzc6kqweyIL4TzIDbr+8GUOGGs1W5jcX5iSNw4DeonzQARlejYJ9NOn/XkrcoC9Hvd8hc5lNx+1h991GxJUJ",
			resultXDR:     "AAAAAAAAAGQAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAA=",
			metaXDR:       "AAAAAQAAAAIAAAADAAAAHAAAAAAAAAAAkFLGCjsP5I/iV1yOXqLAmNi0vn4B9MxR2V53pzCeMFAAAAACVAvhRAAAABsAAAAEAAAAAAAAAAEAAAAAYvwdC9CRsrYcDdZWNGsqaNfTR8bywsjubQRHAlb8BfcAAAADAAAAAAIAAAAAAAAAAAAAAAAAAAAAAAABAAAAHAAAAAAAAAAAkFLGCjsP5I/iV1yOXqLAmNi0vn4B9MxR2V53pzCeMFAAAAACVAvhRAAAABsAAAAFAAAAAAAAAAEAAAAAYvwdC9CRsrYcDdZWNGsqaNfTR8bywsjubQRHAlb8BfcAAAADAAAAAAIAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAMAAAAcAAAAAAAAAACQUsYKOw/kj+JXXI5eosCY2LS+fgH0zFHZXnenMJ4wUAAAAAJUC+FEAAAAGwAAAAUAAAAAAAAAAQAAAABi/B0L0JGythwN1lY0aypo19NHxvLCyO5tBEcCVvwF9wAAAAMAAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAEAAAAcAAAAAAAAAACQUsYKOw/kj+JXXI5eosCY2LS+fgH0zFHZXnenMJ4wUAAAAAJUC+FEAAAAGwAAAAUAAAAAAAAAAQAAAABi/B0L0JGythwN1lY0aypo19NHxvLCyO5tBEcCVvwF9wAAAAMAAAAAAgACAgAAAAAAAAAAAAAAAA==",
			feeChangesXDR: "AAAAAgAAAAMAAAAcAAAAAAAAAACQUsYKOw/kj+JXXI5eosCY2LS+fgH0zFHZXnenMJ4wUAAAAAJUC+JwAAAAGwAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAEAAAAcAAAAAAAAAACQUsYKOw/kj+JXXI5eosCY2LS+fgH0zFHZXnenMJ4wUAAAAAJUC+IMAAAAGwAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA==",
			hash:          "852ba25e0e4aa149a22dc193bcb645ae9eba23e7f7432707f3b910474e9b6a5b",
			index:         0,
			expected: map[string]interface{}{
				"low_threshold":  xdr.Uint32(0),
				"med_threshold":  xdr.Uint32(2),
				"high_threshold": xdr.Uint32(2),
			},
		},
		{
			desc:          "setOption - thresholds (low, medium, high)",
			envelopeXDR:   "AAAAAO5QGSKQkcErWDq9iKwemolyxv8LDVZBwWLQSiYp7iDVAAAAZAAAAAQAAAADAAAAAAAAAAAAAAABAAAAAAAAAAUAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAABAAAAAgAAAAEAAAACAAAAAQAAAAIAAAAAAAAAAAAAAAAAAAABKe4g1QAAAEDglRRymtLjw+ImmGwTiBTKE7X7+2CywlHw8qed+t520SbAggcqboy5KXJaEP51/wRSMxtZUgDOFfaDn9Df04EA",
			resultXDR:     "AAAAAAAAAGQAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAA=",
			metaXDR:       "AAAAAQAAAAIAAAADAAAABQAAAAAAAAAA7lAZIpCRwStYOr2IrB6aiXLG/wsNVkHBYtBKJinuINUAAAACVAvi1AAAAAQAAAACAAAAAQAAAAAAAAAAAAAAAAEAAAAAAAABAAAAAPZPnUyLZ+OYJjhn5Hkk43UuW6rOuemZPFQldOn8DcVHAAAAAQAAAAAAAAAAAAAAAQAAAAUAAAAAAAAAAO5QGSKQkcErWDq9iKwemolyxv8LDVZBwWLQSiYp7iDVAAAAAlQL4tQAAAAEAAAAAwAAAAEAAAAAAAAAAAAAAAABAAAAAAAAAQAAAAD2T51Mi2fjmCY4Z+R5JON1LluqzrnpmTxUJXTp/A3FRwAAAAEAAAAAAAAAAAAAAAEAAAACAAAAAwAAAAUAAAAAAAAAAO5QGSKQkcErWDq9iKwemolyxv8LDVZBwWLQSiYp7iDVAAAAAlQL4tQAAAAEAAAAAwAAAAEAAAAAAAAAAAAAAAABAAAAAAAAAQAAAAD2T51Mi2fjmCY4Z+R5JON1LluqzrnpmTxUJXTp/A3FRwAAAAEAAAAAAAAAAAAAAAEAAAAFAAAAAAAAAADuUBkikJHBK1g6vYisHpqJcsb/Cw1WQcFi0EomKe4g1QAAAAJUC+LUAAAABAAAAAMAAAABAAAAAAAAAAAAAAAAAQICAgAAAAEAAAAA9k+dTItn45gmOGfkeSTjdS5bqs656Zk8VCV06fwNxUcAAAABAAAAAAAAAAA=",
			feeChangesXDR: "AAAAAgAAAAMAAAAFAAAAAAAAAADuUBkikJHBK1g6vYisHpqJcsb/Cw1WQcFi0EomKe4g1QAAAAJUC+M4AAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAAAAAADuUBkikJHBK1g6vYisHpqJcsb/Cw1WQcFi0EomKe4g1QAAAAJUC+LUAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA==",
			hash:          "f78dca926455579b4a43009ffe35a0229a6da4bed32d3c999d7a06ad26605a25",
			index:         0,
			expected: map[string]interface{}{
				"low_threshold":  xdr.Uint32(2),
				"med_threshold":  xdr.Uint32(2),
				"high_threshold": xdr.Uint32(2),
			},
		},
		{
			desc:          "setOption - clears flags",
			envelopeXDR:   "AAAAAJBSxgo7D+SP4ldcjl6iwJjYtL5+AfTMUdled6cwnjBQAAAAZAAAABsAAAALAAAAAAAAAAAAAAABAAAAAAAAAAUAAAAAAAAAAQAAAAMAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABMJ4wUAAAAEAFytUxjxN4bnJMrEJkSprnES9iGpOxAsNOFYrTP/xtGVk/PZ2oThUW+/hLRIk+hYYEgF21Gf58N/abJKFpqlsI",
			resultXDR:     "AAAAAAAAAGQAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAA=",
			metaXDR:       "AAAAAQAAAAIAAAADAAAAIAAAAAAAAAAAkFLGCjsP5I/iV1yOXqLAmNi0vn4B9MxR2V53pzCeMFAAAAACVAvfUAAAABsAAAAKAAAAAQAAAAEAAAAAYvwdC9CRsrYcDdZWNGsqaNfTR8bywsjubQRHAlb8BfcAAAADAAAAC2V4YW1wbGUuY29tAAIAAgIAAAABAAAAAHyd2ctWIE8qo8kBxI2FnNzaYft9DtG3MbIUDyYWQxOQAAAABQAAAAAAAAAAAAAAAQAAACAAAAAAAAAAAJBSxgo7D+SP4ldcjl6iwJjYtL5+AfTMUdled6cwnjBQAAAAAlQL31AAAAAbAAAACwAAAAEAAAABAAAAAGL8HQvQkbK2HA3WVjRrKmjX00fG8sLI7m0ERwJW/AX3AAAAAwAAAAtleGFtcGxlLmNvbQACAAICAAAAAQAAAAB8ndnLViBPKqPJAcSNhZzc2mH7fQ7RtzGyFA8mFkMTkAAAAAUAAAAAAAAAAAAAAAEAAAACAAAAAwAAACAAAAAAAAAAAJBSxgo7D+SP4ldcjl6iwJjYtL5+AfTMUdled6cwnjBQAAAAAlQL31AAAAAbAAAACwAAAAEAAAABAAAAAGL8HQvQkbK2HA3WVjRrKmjX00fG8sLI7m0ERwJW/AX3AAAAAwAAAAtleGFtcGxlLmNvbQACAAICAAAAAQAAAAB8ndnLViBPKqPJAcSNhZzc2mH7fQ7RtzGyFA8mFkMTkAAAAAUAAAAAAAAAAAAAAAEAAAAgAAAAAAAAAACQUsYKOw/kj+JXXI5eosCY2LS+fgH0zFHZXnenMJ4wUAAAAAJUC99QAAAAGwAAAAsAAAABAAAAAQAAAABi/B0L0JGythwN1lY0aypo19NHxvLCyO5tBEcCVvwF9wAAAAAAAAALZXhhbXBsZS5jb20AAgACAgAAAAEAAAAAfJ3Zy1YgTyqjyQHEjYWc3Nph+30O0bcxshQPJhZDE5AAAAAFAAAAAAAAAAA=",
			feeChangesXDR: "AAAAAgAAAAMAAAAfAAAAAAAAAACQUsYKOw/kj+JXXI5eosCY2LS+fgH0zFHZXnenMJ4wUAAAAAJUC+AYAAAAGwAAAAoAAAABAAAAAQAAAABi/B0L0JGythwN1lY0aypo19NHxvLCyO5tBEcCVvwF9wAAAAMAAAALZXhhbXBsZS5jb20AAgACAgAAAAEAAAAAfJ3Zy1YgTyqjyQHEjYWc3Nph+30O0bcxshQPJhZDE5AAAAAFAAAAAAAAAAAAAAABAAAAIAAAAAAAAAAAkFLGCjsP5I/iV1yOXqLAmNi0vn4B9MxR2V53pzCeMFAAAAACVAvftAAAABsAAAAKAAAAAQAAAAEAAAAAYvwdC9CRsrYcDdZWNGsqaNfTR8bywsjubQRHAlb8BfcAAAADAAAAC2V4YW1wbGUuY29tAAIAAgIAAAABAAAAAHyd2ctWIE8qo8kBxI2FnNzaYft9DtG3MbIUDyYWQxOQAAAABQAAAAAAAAAA",
			hash:          "bb9d6654111fae501594400dc901c70d47489a67163d2a34f9b3e32a921a50dc",
			index:         0,
			expected: map[string]interface{}{
				"clear_flags": []int32{1, 2},
				"clear_flags_s": []string{
					"auth_required",
					"auth_revocable",
				},
			},
		},
		{
			desc:          "changeTrust",
			envelopeXDR:   "AAAAAKturFHJX/eRt5gM6qIXAMbaXvlImqLysA6Qr9tLemxfAAAAZAAAACYAAAABAAAAAAAAAAAAAAABAAAAAAAAAAYAAAABVVNEAAAAAAD5Jjibq+Rf5jsUyQ2/tGzCwiRg0Zd5nj9jARA1Skjz+H//////////AAAAAAAAAAFLemxfAAAAQKN8LftAafeoAGmvpsEokqm47jAuqw4g1UWjmL0j6QPm1jxoalzDwDS3W+N2HOHdjSJlEQaTxGBfQKHhr6nNsAA=",
			resultXDR:     "AAAAAAAAAGQAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAA=",
			metaXDR:       "AAAAAQAAAAIAAAADAAAAKAAAAAAAAAAAq26sUclf95G3mAzqohcAxtpe+UiaovKwDpCv20t6bF8AAAACVAvjOAAAACYAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAABAAAAKAAAAAAAAAAAq26sUclf95G3mAzqohcAxtpe+UiaovKwDpCv20t6bF8AAAACVAvjOAAAACYAAAABAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAABAAAAAwAAAAMAAAAoAAAAAAAAAACrbqxRyV/3kbeYDOqiFwDG2l75SJqi8rAOkK/bS3psXwAAAAJUC+M4AAAAJgAAAAEAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAEAAAAoAAAAAAAAAACrbqxRyV/3kbeYDOqiFwDG2l75SJqi8rAOkK/bS3psXwAAAAJUC+M4AAAAJgAAAAEAAAABAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAoAAAAAQAAAACrbqxRyV/3kbeYDOqiFwDG2l75SJqi8rAOkK/bS3psXwAAAAFVU0QAAAAAAPkmOJur5F/mOxTJDb+0bMLCJGDRl3meP2MBEDVKSPP4AAAAAAAAAAB//////////wAAAAAAAAAAAAAAAA==",
			feeChangesXDR: "AAAAAgAAAAMAAAAmAAAAAAAAAACrbqxRyV/3kbeYDOqiFwDG2l75SJqi8rAOkK/bS3psXwAAAAJUC+QAAAAAJgAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAEAAAAoAAAAAAAAAACrbqxRyV/3kbeYDOqiFwDG2l75SJqi8rAOkK/bS3psXwAAAAJUC+OcAAAAJgAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA==",
			hash:          "6fa467b53f5386d77ad35c2502ed2cd3dd8b460a5be22b6b2818b81bcd3ed2da",
			index:         0,
			expected: map[string]interface{}{
				"asset_code":   "USD",
				"asset_issuer": "GD4SMOE3VPSF7ZR3CTEQ3P5UNTBMEJDA2GLXTHR7MMARANKKJDZ7RPGF",
				"asset_type":   "credit_alphanum4",
				"limit":        "922337203685.4775807",
				"trustee":      "GD4SMOE3VPSF7ZR3CTEQ3P5UNTBMEJDA2GLXTHR7MMARANKKJDZ7RPGF",
				"trustor":      "GCVW5LCRZFP7PENXTAGOVIQXADDNUXXZJCNKF4VQB2IK7W2LPJWF73UG",
			},
		},
		{
			desc:          "allowTrust",
			envelopeXDR:   "AAAAAPkmOJur5F/mOxTJDb+0bMLCJGDRl3meP2MBEDVKSPP4AAAAZAAAACYAAAACAAAAAAAAAAAAAAABAAAAAAAAAAcAAAAAq26sUclf95G3mAzqohcAxtpe+UiaovKwDpCv20t6bF8AAAABVVNEAAAAAAEAAAAAAAAAAUpI8/gAAABA6O2fe1gQBwoO0fMNNEUKH0QdVXVjEWbN5VL51DmRUedYMMXtbX5JKVSzla2kIGvWgls1dXuXHZY/IOlaK01rBQ==",
			resultXDR:     "AAAAAAAAAGQAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAA=",
			metaXDR:       "AAAAAQAAAAIAAAADAAAAKQAAAAAAAAAA+SY4m6vkX+Y7FMkNv7RswsIkYNGXeZ4/YwEQNUpI8/gAAAACVAvi1AAAACYAAAABAAAAAAAAAAAAAAADAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAABAAAAKQAAAAAAAAAA+SY4m6vkX+Y7FMkNv7RswsIkYNGXeZ4/YwEQNUpI8/gAAAACVAvi1AAAACYAAAACAAAAAAAAAAAAAAADAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAMAAAAoAAAAAQAAAACrbqxRyV/3kbeYDOqiFwDG2l75SJqi8rAOkK/bS3psXwAAAAFVU0QAAAAAAPkmOJur5F/mOxTJDb+0bMLCJGDRl3meP2MBEDVKSPP4AAAAAAAAAAB//////////wAAAAAAAAAAAAAAAAAAAAEAAAApAAAAAQAAAACrbqxRyV/3kbeYDOqiFwDG2l75SJqi8rAOkK/bS3psXwAAAAFVU0QAAAAAAPkmOJur5F/mOxTJDb+0bMLCJGDRl3meP2MBEDVKSPP4AAAAAAAAAAB//////////wAAAAEAAAAAAAAAAA==",
			feeChangesXDR: "AAAAAgAAAAMAAAAnAAAAAAAAAAD5Jjibq+Rf5jsUyQ2/tGzCwiRg0Zd5nj9jARA1Skjz+AAAAAJUC+OcAAAAJgAAAAEAAAAAAAAAAAAAAAMAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAEAAAApAAAAAAAAAAD5Jjibq+Rf5jsUyQ2/tGzCwiRg0Zd5nj9jARA1Skjz+AAAAAJUC+M4AAAAJgAAAAEAAAAAAAAAAAAAAAMAAAAAAQAAAAAAAAAAAAAAAAAAAA==",
			hash:          "6d2e30fd57492bf2e2b132e1bc91a548a369189bebf77eb2b3d829121a9d2c50",
			index:         0,
			expected: map[string]interface{}{
				"asset_code":   "USD",
				"asset_issuer": "GD4SMOE3VPSF7ZR3CTEQ3P5UNTBMEJDA2GLXTHR7MMARANKKJDZ7RPGF",
				"asset_type":   "credit_alphanum4",
				"authorize":    true,
				"trustee":      "GD4SMOE3VPSF7ZR3CTEQ3P5UNTBMEJDA2GLXTHR7MMARANKKJDZ7RPGF",
				"trustor":      "GCVW5LCRZFP7PENXTAGOVIQXADDNUXXZJCNKF4VQB2IK7W2LPJWF73UG",
			},
		},
		{
			desc:          "accountMerge (Destination)",
			envelopeXDR:   "AAAAAI77mqNTy9VPgmgn+//uvjP8VJxJ1FHQ4jCrYS+K4+HvAAAAZAAAACsAAAABAAAAAAAAAAAAAAABAAAAAAAAAAgAAAAAYvwdC9CRsrYcDdZWNGsqaNfTR8bywsjubQRHAlb8BfcAAAAAAAAAAYrj4e8AAABA3jJ7wBrRpsrcnqBQWjyzwvVz2v5UJ56G60IhgsaWQFSf+7om462KToc+HJ27aLVOQ83dGh1ivp+VIuREJq/SBw==",
			resultXDR:     "AAAAAAAAAGQAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAA=",
			metaXDR:       "AAAAAQAAAAIAAAADAAAALAAAAAAAAAAAjvuao1PL1U+CaCf7/+6+M/xUnEnUUdDiMKthL4rj4e8AAAACVAvjnAAAACsAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAABAAAALAAAAAAAAAAAjvuao1PL1U+CaCf7/+6+M/xUnEnUUdDiMKthL4rj4e8AAAACVAvjnAAAACsAAAABAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAABAAAABAAAAAMAAAArAAAAAAAAAABi/B0L0JGythwN1lY0aypo19NHxvLCyO5tBEcCVvwF9w3gtonM3Az4AAAAAAAAABIAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAEAAAAsAAAAAAAAAABi/B0L0JGythwN1lY0aypo19NHxvLCyO5tBEcCVvwF9w3gtowg5/CUAAAAAAAAABIAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAMAAAAsAAAAAAAAAACO+5qjU8vVT4JoJ/v/7r4z/FScSdRR0OIwq2EviuPh7wAAAAJUC+OcAAAAKwAAAAEAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAI77mqNTy9VPgmgn+//uvjP8VJxJ1FHQ4jCrYS+K4+Hv",
			feeChangesXDR: "AAAAAgAAAAMAAAArAAAAAAAAAACO+5qjU8vVT4JoJ/v/7r4z/FScSdRR0OIwq2EviuPh7wAAAAJUC+QAAAAAKwAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAEAAAAsAAAAAAAAAACO+5qjU8vVT4JoJ/v/7r4z/FScSdRR0OIwq2EviuPh7wAAAAJUC+OcAAAAKwAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA==",
			hash:          "e0773d07aba23d11e6a06b021682294be1f9f202a2926827022539662ce2c7fc",
			index:         0,
			expected: map[string]interface{}{
				"into":    "GBRPYHIL2CI3FNQ4BXLFMNDLFJUNPU2HY3ZMFSHONUCEOASW7QC7OX2H",
				"account": "GCHPXGVDKPF5KT4CNAT7X77OXYZ7YVE4JHKFDUHCGCVWCL4K4PQ67KKZ",
			},
		},
		{
			desc:          "inflation",
			envelopeXDR:   "AAAAAGL8HQvQkbK2HA3WVjRrKmjX00fG8sLI7m0ERwJW/AX3AAAAZAAAAAAAAAAVAAAAAAAAAAAAAAABAAAAAAAAAAkAAAAAAAAAAVb8BfcAAABABUHuXY+MTgW/wDv5+NDVh9fw4meszxeXO98HEQfgXVeCZ7eObCI2orSGUNA/SK6HV9/uTVSxIQQWIso1QoxHBQ==",
			resultXDR:     "AAAAAAAAAGQAAAAAAAAAAQAAAAAAAAAJAAAAAAAAAAIAAAAAYvwdC9CRsrYcDdZWNGsqaNfTR8bywsjubQRHAlb8BfcAAIrEjCYwXAAAAADj3dgEQp1N5U3fBSOCx/nr5XtiCmNJ2oMJZMx+MYK3JwAAIrEjfceLAAAAAA==",
			metaXDR:       "AAAAAQAAAAIAAAADAAAALwAAAAAAAAAAYvwdC9CRsrYcDdZWNGsqaNfTR8bywsjubQRHAlb8BfcLGiubZdPvaAAAAAAAAAAUAAAAAAAAAAEAAAAAYvwdC9CRsrYcDdZWNGsqaNfTR8bywsjubQRHAlb8BfcAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAABAAAALwAAAAAAAAAAYvwdC9CRsrYcDdZWNGsqaNfTR8bywsjubQRHAlb8BfcLGiubZdPvaAAAAAAAAAAVAAAAAAAAAAEAAAAAYvwdC9CRsrYcDdZWNGsqaNfTR8bywsjubQRHAlb8BfcAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAABAAAABAAAAAMAAAAvAAAAAAAAAABi/B0L0JGythwN1lY0aypo19NHxvLCyO5tBEcCVvwF9wsaK5tl0+9oAAAAAAAAABUAAAAAAAAAAQAAAABi/B0L0JGythwN1lY0aypo19NHxvLCyO5tBEcCVvwF9wAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAEAAAAvAAAAAAAAAABi/B0L0JGythwN1lY0aypo19NHxvLCyO5tBEcCVvwF9wsatl/x+h/EAAAAAAAAABUAAAAAAAAAAQAAAABi/B0L0JGythwN1lY0aypo19NHxvLCyO5tBEcCVvwF9wAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAMAAAAuAAAAAAAAAADj3dgEQp1N5U3fBSOCx/nr5XtiCmNJ2oMJZMx+MYK3JwLGivC7E/+cAAAALQAAAAEAAAAAAAAAAQAAAADj3dgEQp1N5U3fBSOCx/nr5XtiCmNJ2oMJZMx+MYK3JwAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAEAAAAvAAAAAAAAAADj3dgEQp1N5U3fBSOCx/nr5XtiCmNJ2oMJZMx+MYK3JwLGraHekccnAAAALQAAAAEAAAAAAAAAAQAAAADj3dgEQp1N5U3fBSOCx/nr5XtiCmNJ2oMJZMx+MYK3JwAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA==",
			feeChangesXDR: "AAAAAgAAAAMAAAAuAAAAAAAAAABi/B0L0JGythwN1lY0aypo19NHxvLCyO5tBEcCVvwF9wsaK5tl0+/MAAAAAAAAABQAAAAAAAAAAQAAAABi/B0L0JGythwN1lY0aypo19NHxvLCyO5tBEcCVvwF9wAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAEAAAAvAAAAAAAAAABi/B0L0JGythwN1lY0aypo19NHxvLCyO5tBEcCVvwF9wsaK5tl0+9oAAAAAAAAABQAAAAAAAAAAQAAAABi/B0L0JGythwN1lY0aypo19NHxvLCyO5tBEcCVvwF9wAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA==",
			hash:          "ea93efd8c2f4e45c0318c69ec958623a0e4374f40d569eec124d43c8a54d6256",
			index:         0,
			expected:      map[string]interface{}{},
		},
		{
			desc:        "manageData",
			envelopeXDR: "AAAAADEhMVDHiYXdz5z8l73XGyrQ2RN85ZRW1uLsCNQumfsZAAAAZAAAADAAAAACAAAAAAAAAAAAAAABAAAAAAAAAAoAAAAFbmFtZTIAAAAAAAABAAAABDU2NzgAAAAAAAAAAS6Z+xkAAABAjxgnTRBCa0n1efZocxpEjXeITQ5sEYTVd9fowuto2kPw5eFwgVnz6OrKJwCRt5L8ylmWiATXVI3Zyfi3yTKqBA==",

			resultXDR:     "AAAAAAAAAGQAAAAAAAAAAQAAAAAAAAAKAAAAAAAAAAA=",
			metaXDR:       "AAAAAQAAAAIAAAADAAAAMQAAAAAAAAAAMSExUMeJhd3PnPyXvdcbKtDZE3zllFbW4uwI1C6Z+xkAAAACVAvi1AAAADAAAAABAAAAAQAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAABAAAAMQAAAAAAAAAAMSExUMeJhd3PnPyXvdcbKtDZE3zllFbW4uwI1C6Z+xkAAAACVAvi1AAAADAAAAACAAAAAQAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAABAAAAAwAAAAMAAAAxAAAAAAAAAAAxITFQx4mF3c+c/Je91xsq0NkTfOWUVtbi7AjULpn7GQAAAAJUC+LUAAAAMAAAAAIAAAABAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAEAAAAxAAAAAAAAAAAxITFQx4mF3c+c/Je91xsq0NkTfOWUVtbi7AjULpn7GQAAAAJUC+LUAAAAMAAAAAIAAAACAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAxAAAAAwAAAAAxITFQx4mF3c+c/Je91xsq0NkTfOWUVtbi7AjULpn7GQAAAAVuYW1lMgAAAAAAAAQ1Njc4AAAAAAAAAAA=",
			feeChangesXDR: "AAAAAgAAAAMAAAAxAAAAAAAAAAAxITFQx4mF3c+c/Je91xsq0NkTfOWUVtbi7AjULpn7GQAAAAJUC+OcAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAEAAAAxAAAAAAAAAAAxITFQx4mF3c+c/Je91xsq0NkTfOWUVtbi7AjULpn7GQAAAAJUC+M4AAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA==",
			hash:          "e4609180751e7702466a8845857df43e4d154ec84b6bad62ce507fe12f1daf99",
			index:         0,
			expected: map[string]interface{}{
				"name":  "name2",
				"value": "NTY3OA==",
			},
		},
		{
			desc:        "bumpSequence",
			envelopeXDR: "AAAAAKGX7RT96eIn205uoUHYnqLbt2cPRNORraEoeTAcrRKUAAAAZAAAAEXZZLgDAAAAAAAAAAAAAAABAAAAAAAAAAsAAABF2WS4AwAAAAAAAAABHK0SlAAAAECcI6ex0Dq6YAh6aK14jHxuAvhvKG2+NuzboAKrfYCaC1ZSQ77BYH/5MghPX97JO9WXV17ehNK7d0umxBgaJj8A",

			resultXDR:     "AAAAAAAAAGQAAAAAAAAAAQAAAAAAAAALAAAAAAAAAAA=",
			metaXDR:       "AAAAAQAAAAIAAAADAAAAPQAAAAAAAAAAoZftFP3p4ifbTm6hQdieotu3Zw9E05GtoSh5MBytEpQAAAACVAvicAAAAEXZZLgCAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAABAAAAPQAAAAAAAAAAoZftFP3p4ifbTm6hQdieotu3Zw9E05GtoSh5MBytEpQAAAACVAvicAAAAEXZZLgDAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAABAAAAAA==",
			feeChangesXDR: "AAAAAgAAAAMAAAA8AAAAAAAAAAChl+0U/eniJ9tObqFB2J6i27dnD0TTka2hKHkwHK0SlAAAAAJUC+LUAAAARdlkuAIAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAEAAAA9AAAAAAAAAAChl+0U/eniJ9tObqFB2J6i27dnD0TTka2hKHkwHK0SlAAAAAJUC+JwAAAARdlkuAIAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA==",
			hash:          "bc11b5c41de791369fd85fa1ccf01c35c20df5f98ff2f75d02ead61bfd520e21",
			index:         0,
			expected: map[string]interface{}{
				"bump_to": "300000000003",
			},
		},
		{
			desc:          "manageBuyOffer",
			envelopeXDR:   "AAAAAJ/0uhpjIPNaeEcEqBy5SVquaG77leHg6iNYV67vrxFhAAAAZAAFedEAAAAQAAAAAQAAAAAAAAAAAAAAAF3cTA8AAAABAAAADk1ha2UgQnV5IE9mZmVyAAAAAAABAAAAAAAAAAwAAAABWENaAAAAAAC0GeXnSSrjPt5iaVo8DbLiZW0sHr2WP9zMWYuGMrdEhQAAAAAAAAAANZresAAAAAgAAAABAAAAAAAAAAAAAAAAAAAAAe+vEWEAAABAY0cI3kQXv1EcCDDmf3hCKLLEiinkVPB2+rAJe8PnA8WY8r27xGr5LCikUj8n7wEAtzMM83VcPYIMoJROYMjvCA==",
			resultXDR:     "AAAAAAAAAGQAAAAAAAAAAQAAAAAAAAAMAAAAAAAAAAIAAAAAs/VGFE8UPc+joxmES67/oVFj3tKJVdCzBqJoIsmWHmkAAAAAAEPjtgAAAAAAAAAAL3ix2AAAAAFYQ1oAAAAAALQZ5edJKuM+3mJpWjwNsuJlbSwevZY/3MxZi4Yyt0SFAAAAAAXvFjsAAAAAgFKhklnQv7X44QJm0yDkmvjtZFHs+O65cfO+EhWwOdQAAAAAAEPkBgAAAAAAAAAABiIs2AAAAAFYQ1oAAAAAALQZ5edJKuM+3mJpWjwNsuJlbSwevZY/3MxZi4Yyt0SFAAAAAADERZsAAAACAAAAAA==",
			metaXDR:       "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",
			feeChangesXDR: "AAAAAgAAAAMABjMvAAAAAAAAAACf9LoaYyDzWnhHBKgcuUlarmhu+5Xh4OojWFeu768RYQAAABdgScMrAAV50QAAAA8AAAAEAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAABAAAAAAAAAAAAAAAAHtE0uAAAAAAAAAAAAAAAAQAGaD0AAAAAAAAAAJ/0uhpjIPNaeEcEqBy5SVquaG77leHg6iNYV67vrxFhAAAAF2BJwscABXnRAAAADwAAAAQAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAe0TS4AAAAAAAAAAA=",
			hash:          "94b050b55dfdfa55dc46889b6f6b5798c24cf77983562826a74db058ff0eb5b4",
			index:         0,
			expected: map[string]interface{}{
				"price":  "8.0000000",
				"amount": "89.9342000",
				"price_r": map[string]interface{}{
					"d": xdr.Int32(1),
					"n": xdr.Int32(8),
				},
				"offer_id":             xdr.Int64(0),
				"buying_asset_type":    "native",
				"selling_asset_code":   "XCZ",
				"selling_asset_type":   "credit_alphanum4",
				"selling_asset_issuer": "GC2BTZPHJEVOGPW6MJUVUPANWLRGK3JMD26ZMP64ZRMYXBRSW5CIKEW5",
			},
		},
		{
			desc:          "pathPaymentStrictSend",
			envelopeXDR:   "AAAAAOsC3UuQJXeJWl7o2Q9Wf2RvZiHiHKfSbtDNsXkn3NMiAAAAZAAKTgQAAAABAAAAAAAAAAAAAAABAAAAAAAAAA0AAAAAAAAAAAX14QAAAAAA4VWYSXp7+QFjS8+8WzU2KJTONKIIk2FHXORcby4KqbgAAAAAAAAAAAX14QAAAAABAAAAAAAAAAAAAAABJ9zTIgAAAEBPAPVBKa8d5/DyiTghHO8OnFNtxa4WSMW1geqCH+83EL+yyLszkzdIWSBX8/N9FC1Mo+DTRF/peVAsxlL4G04N",
			resultXDR:     "AAAAAAAAAGQAAAAAAAAAAQAAAAAAAAANAAAAAAAAAAAAAAAA4VWYSXp7+QFjS8+8WzU2KJTONKIIk2FHXORcby4KqbgAAAAAAAAAAAX14QAAAAAA",
			metaXDR:       "AAAAAQAAAAIAAAADAApOFQAAAAAAAAAA6wLdS5Ald4laXujZD1Z/ZG9mIeIcp9Ju0M2xeSfc0yIAAAAXSHbnnAAKTgQAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAABAApOFQAAAAAAAAAA6wLdS5Ald4laXujZD1Z/ZG9mIeIcp9Ju0M2xeSfc0yIAAAAXSHbnnAAKTgQAAAABAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAABAAAABAAAAAMACk4VAAAAAAAAAADrAt1LkCV3iVpe6NkPVn9kb2Yh4hyn0m7QzbF5J9zTIgAAABdIduecAApOBAAAAAEAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAEACk4VAAAAAAAAAADrAt1LkCV3iVpe6NkPVn9kb2Yh4hyn0m7QzbF5J9zTIgAAABdCgQacAApOBAAAAAEAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAMABZwuAAAAAAAAAADhVZhJenv5AWNLz7xbNTYolM40ogiTYUdc5FxvLgqpuAAAAAAAmJaAAAWcLgAAAAAAAAAAAAAAAAAAAAQAAAARdHN0LnRlc3Rhc3NldC5jb20AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAKThUAAAAAAAAAAOFVmEl6e/kBY0vPvFs1NiiUzjSiCJNhR1zkXG8uCqm4AAAAAAaOd4AABZwuAAAAAAAAAAAAAAAAAAAABAAAABF0c3QudGVzdGFzc2V0LmNvbQAAAAAAAAAAAAAAAAAAAAAAAAA=",
			feeChangesXDR: "AAAAAgAAAAMACk4EAAAAAAAAAADrAt1LkCV3iVpe6NkPVn9kb2Yh4hyn0m7QzbF5J9zTIgAAABdIdugAAApOBAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAEACk4VAAAAAAAAAADrAt1LkCV3iVpe6NkPVn9kb2Yh4hyn0m7QzbF5J9zTIgAAABdIduecAApOBAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA==",
			hash:          "5cbb2e13e2ddd72075b6c7e83eb018d0092c27972bf1f0343b83be9c5f964b62",
			index:         0,
			expected: map[string]interface{}{
				"amount":            "10.0000000",
				"asset_type":        "native",
				"destination_min":   "10.0000000",
				"from":              "GDVQFXKLSASXPCK2L3UNSD2WP5SG6ZRB4IOKPUTO2DG3C6JH3TJSEA7R",
				"path":              []map[string]interface{}{{"asset_type": "native"}},
				"source_amount":     "10.0000000",
				"source_asset_type": "native",
				"to":                "GDQVLGCJPJ57SALDJPH3YWZVGYUJJTRUUIEJGYKHLTSFY3ZOBKU3QIO3",
			},
		},
		{
			desc:          "revokeSponsorship (signer)",
			envelopeXDR:   getRevokeSponsorshipEnvelopeXDR(t),
			resultXDR:     "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
			metaXDR:       "AAAAAgAAAAAAAAABAAAAAAAAAAA=",
			feeChangesXDR: "AAAAAA==",
			hash:          "a41d1c8cdf515203ac5a10d945d5023325076b23dbe7d65ae402cd5f8cd9f891",
			index:         0,
			expected: map[string]interface{}{
				"signer_account_id": "GAHK7EEG2WWHVKDNT4CEQFZGKF2LGDSW2IVM4S5DP42RBW3K6BTODB4A",
				"signer_key":        "GCAHY6JSXQFKWKP6R7U5JPXDVNV4DJWOWRFLY3Y6YPBF64QRL4BPFDNS",
			},
		},
		{
			desc:          "revokeSponsorship (ledger key)",
			envelopeXDR:   "AAAAAgAAAAAokk0ZqR+mxwuhJJ2uXvNqIhmObygxBFIJKvQgf/7fqwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAASAAAAAAAAAAQAAAAAyv66vgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==",
			resultXDR:     "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
			metaXDR:       "AAAAAgAAAAAAAAABAAAAAAAAAAA=",
			feeChangesXDR: "AAAAAA==",
			hash:          "13658aed93a0cb60582491a8eb945eb9b7737a7560324dd2b24f2acfe5090ada",
			index:         0,
			expected: map[string]interface{}{
				"claimable_balance_id": "00000000cafebabe00000000000000000000000000000000000000000000000000000000",
			},
		},
		{
			desc:          "clawbackClaimableBalance",
			envelopeXDR:   "AAAAAgAAAADrAt1LkCV3iVpe6NkPVn9kb2Yh4hyn0m7QzbF5J9zTIgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAUAAAAAMr+ur7erb7vAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=",
			resultXDR:     "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
			metaXDR:       "AAAAAgAAAAAAAAABAAAAAAAAAAA=",
			feeChangesXDR: "AAAAAA==",
			hash:          "b803cd72c77fb1cf95dd94048b14e02abf8694ef9124b10e9620b83a8b15804f",
			index:         0,
			expected: map[string]interface{}{
				"balance_id": "00000000cafebabedeadbeef000000000000000000000000000000000000000000000000",
			},
		},
	}

	for _, tc := range testCases {
		t.Run(tc.desc, func(t *testing.T) {
			tt := assert.New(t)
			transaction := BuildLedgerTransaction(
				t,
				TestTransaction{
					Index:         1,
					EnvelopeXDR:   tc.envelopeXDR,
					ResultXDR:     tc.resultXDR,
					MetaXDR:       tc.metaXDR,
					FeeChangesXDR: tc.feeChangesXDR,
					Hash:          tc.hash,
				},
			)

			operation := transactionOperationWrapper{
				index:          tc.index,
				transaction:    transaction,
				operation:      transaction.Envelope.Operations()[tc.index],
				ledgerSequence: 1,
			}
			details, err := operation.Details()
			tt.NoError(err)
			tt.Equal(tc.expected, details)
		})
	}

	tx := createTransaction(true, 1)
	tx.Index = 1

	tx.Envelope.Operations()[0].Body = xdr.OperationBody{
		Type: xdr.OperationTypeRevokeSponsorship,
		RevokeSponsorshipOp: &xdr.RevokeSponsorshipOp{
			Type: xdr.RevokeSponsorshipTypeRevokeSponsorshipLedgerEntry,
			LedgerKey: &xdr.LedgerKey{
				Type: xdr.LedgerEntryTypeClaimableBalance,
				ClaimableBalance: &xdr.LedgerKeyClaimableBalance{
					BalanceId: xdr.ClaimableBalanceId{
						Type: 0,
						V0:   &xdr.Hash{0xca, 0xfe, 0xba, 0xbe},
					},
				},
			},
		},
	}
}

func TestTransactionOperationParticipants(t *testing.T) {
	testCases := []struct {
		desc          string
		envelopeXDR   string
		resultXDR     string
		metaXDR       string
		feeChangesXDR string
		hash          string
		index         uint32
		expected      []xdr.AccountId
	}{
		{
			desc:          "createAccount",
			envelopeXDR:   "AAAAAGL8HQvQkbK2HA3WVjRrKmjX00fG8sLI7m0ERwJW/AX3AAAAZAAAAAAAAAAaAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAoZftFP3p4ifbTm6hQdieotu3Zw9E05GtoSh5MBytEpQAAAACVAvkAAAAAAAAAAABVvwF9wAAAEDHU95E9wxgETD8TqxUrkgC0/7XHyNDts6Q5huRHfDRyRcoHdv7aMp/sPvC3RPkXjOMjgbKJUX7SgExUeYB5f8F",
			resultXDR:     "AAAAAAAAAGQAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAA=",
			metaXDR:       "AAAAAQAAAAIAAAADAAAAOQAAAAAAAAAAYvwdC9CRsrYcDdZWNGsqaNfTR8bywsjubQRHAlb8BfcLGrZY9dZxbAAAAAAAAAAZAAAAAAAAAAEAAAAAYvwdC9CRsrYcDdZWNGsqaNfTR8bywsjubQRHAlb8BfcAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAABAAAAOQAAAAAAAAAAYvwdC9CRsrYcDdZWNGsqaNfTR8bywsjubQRHAlb8BfcLGrZY9dZxbAAAAAAAAAAaAAAAAAAAAAEAAAAAYvwdC9CRsrYcDdZWNGsqaNfTR8bywsjubQRHAlb8BfcAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAABAAAAAwAAAAMAAAA5AAAAAAAAAABi/B0L0JGythwN1lY0aypo19NHxvLCyO5tBEcCVvwF9wsatlj11nFsAAAAAAAAABoAAAAAAAAAAQAAAABi/B0L0JGythwN1lY0aypo19NHxvLCyO5tBEcCVvwF9wAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAEAAAA5AAAAAAAAAABi/B0L0JGythwN1lY0aypo19NHxvLCyO5tBEcCVvwF9wsatlahyo1sAAAAAAAAABoAAAAAAAAAAQAAAABi/B0L0JGythwN1lY0aypo19NHxvLCyO5tBEcCVvwF9wAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAA5AAAAAAAAAAChl+0U/eniJ9tObqFB2J6i27dnD0TTka2hKHkwHK0SlAAAAAJUC+QAAAAAOQAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA==",
			feeChangesXDR: "AAAAAgAAAAMAAAA3AAAAAAAAAABi/B0L0JGythwN1lY0aypo19NHxvLCyO5tBEcCVvwF9wsatlj11nHQAAAAAAAAABkAAAAAAAAAAQAAAABi/B0L0JGythwN1lY0aypo19NHxvLCyO5tBEcCVvwF9wAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAEAAAA5AAAAAAAAAABi/B0L0JGythwN1lY0aypo19NHxvLCyO5tBEcCVvwF9wsatlj11nFsAAAAAAAAABkAAAAAAAAAAQAAAABi/B0L0JGythwN1lY0aypo19NHxvLCyO5tBEcCVvwF9wAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA==",
			hash:          "0e5bd332291e3098e49886df2cdb9b5369a5f9e0a9973f0d9e1a9489c6581ba2",
			index:         0,
			expected: []xdr.AccountId{
				xdr.MustAddress("GBRPYHIL2CI3FNQ4BXLFMNDLFJUNPU2HY3ZMFSHONUCEOASW7QC7OX2H"),
				xdr.MustAddress("GCQZP3IU7XU6EJ63JZXKCQOYT2RNXN3HB5CNHENNUEUHSMA4VUJJJSEN"),
			},
		},
		{
			desc:          "payment - same destination as source",
			envelopeXDR:   "AAAAABpcjiETZ0uhwxJJhgBPYKWSVJy2TZ2LI87fqV1cUf/UAAAAZAAAADcAAAABAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAGlyOIRNnS6HDEkmGAE9gpZJUnLZNnYsjzt+pXVxR/9QAAAAAAAAAAAX14QAAAAAAAAAAAVxR/9QAAABAK6pcXYMzAEmH08CZ1LWmvtNDKauhx+OImtP/Lk4hVTMJRVBOebVs5WEPj9iSrgGT0EswuDCZ2i5AEzwgGof9Ag==",
			resultXDR:     "AAAAAAAAAGQAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAA=",
			metaXDR:       "AAAAAQAAAAIAAAADAAAAOAAAAAAAAAAAGlyOIRNnS6HDEkmGAE9gpZJUnLZNnYsjzt+pXVxR/9QAAAACVAvjnAAAADcAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAABAAAAOAAAAAAAAAAAGlyOIRNnS6HDEkmGAE9gpZJUnLZNnYsjzt+pXVxR/9QAAAACVAvjnAAAADcAAAABAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAABAAAAAA==",
			feeChangesXDR: "AAAAAgAAAAMAAAA3AAAAAAAAAAAaXI4hE2dLocMSSYYAT2ClklSctk2diyPO36ldXFH/1AAAAAJUC+QAAAAANwAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAEAAAA4AAAAAAAAAAAaXI4hE2dLocMSSYYAT2ClklSctk2diyPO36ldXFH/1AAAAAJUC+OcAAAANwAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA==",
			hash:          "2a805712c6d10f9e74bb0ccf54ae92a2b4b1e586451fe8133a2433816f6b567c",
			index:         0,
			expected: []xdr.AccountId{
				xdr.MustAddress("GANFZDRBCNTUXIODCJEYMACPMCSZEVE4WZGZ3CZDZ3P2SXK4KH75IK6Y"),
			},
		},
		{
			desc:          "payment - destination and source are different",
			envelopeXDR:   "AAAAAGk/nUZSIwC34ltdN0iqxq+m+0UAWAilH1lZDMM07nODAAAAZAALscMAAAABAAAAAQAAAAAAAAAAAAAAAF35J+sAAAABAAAACjEyMDgwNDc1NDIAAAAAAAEAAAAAAAAAAQAAAABbpsBvIu34ZyHMCzALP5ZzWU604GJX6h9tyk49T5gDwAAAAAAAAAACVAvkAAAAAAAAAAABNO5zgwAAAEDktE4HWENBP01or+tVTmLlDM5J4rwvt0qUZ0wB6fZKbevr+j8Y2eem0lQPjAqk/jdL/KkpFantFd+NKgK+48YO",
			resultXDR:     "AAAAAAAAAGQAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAA=",
			metaXDR:       "AAAAAQAAAAIAAAADAAuxxAAAAAAAAAAAaT+dRlIjALfiW103SKrGr6b7RQBYCKUfWVkMwzTuc4MAAAAXSHbnnAALscMAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAABAAuxxAAAAAAAAAAAaT+dRlIjALfiW103SKrGr6b7RQBYCKUfWVkMwzTuc4MAAAAXSHbnnAALscMAAAABAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAABAAAABAAAAAMAC7GlAAAAAAAAAABbpsBvIu34ZyHMCzALP5ZzWU604GJX6h9tyk49T5gDwAAAAAAX14OcAABp9wAAT4AAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAEAC7HEAAAAAAAAAABbpsBvIu34ZyHMCzALP5ZzWU604GJX6h9tyk49T5gDwAAAAAJr42ecAABp9wAAT4AAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAMAC7HEAAAAAAAAAABpP51GUiMAt+JbXTdIqsavpvtFAFgIpR9ZWQzDNO5zgwAAABdIduecAAuxwwAAAAEAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAEAC7HEAAAAAAAAAABpP51GUiMAt+JbXTdIqsavpvtFAFgIpR9ZWQzDNO5zgwAAABT0awOcAAuxwwAAAAEAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA==",
			feeChangesXDR: "AAAAAgAAAAMAC7HDAAAAAAAAAABpP51GUiMAt+JbXTdIqsavpvtFAFgIpR9ZWQzDNO5zgwAAABdIdugAAAuxwwAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAEAC7HEAAAAAAAAAABpP51GUiMAt+JbXTdIqsavpvtFAFgIpR9ZWQzDNO5zgwAAABdIduecAAuxwwAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA==",
			hash:          "152dafa4699b954272d9896939d2ecd99e39a809713acb99680380e7f0074f89",
			index:         0,
			expected: []xdr.AccountId{
				xdr.MustAddress("GBUT7HKGKIRQBN7CLNOTOSFKY2X2N62FABMARJI7LFMQZQZU5ZZYHXXG"),
				xdr.MustAddress("GBN2NQDPELW7QZZBZQFTACZ7SZZVSTVU4BRFP2Q7NXFE4PKPTAB4AY4S"),
			},
		},
		{
			desc:          "pathPaymentStrictReceive",
			envelopeXDR:   "AAAAAONt/6wGI884Zi6sYDYC1GOV/drnh4OcRrTrqJPoOTUKAAAAZAAAABAAAAADAAAAAAAAAAAAAAABAAAAAAAAAAIAAAAAAAAAADuaygAAAAAABAjoBMEUiZNLUjsWXL1iK59D90Li4w56076b8HKxZfIAAAABRVVSAAAAAAAuwvNzNk9twbuJHUBqnX26GYI3MbCdpQU9t4n6EVRXsQAAAAA7msoAAAAAAAAAAAAAAAAB6Dk1CgAAAEB+7jxesBKKrF343onyycjp2tiQLZiGH2ETl+9fuOqotveY2rIgvt9ng+QJ2aDP3+PnDsYEa9ZUaA+Zne2nIGgE",
			resultXDR:     "AAAAAAAAAGQAAAAAAAAAAQAAAAAAAAACAAAAAAAAAAEAAAAALsLzczZPbcG7iR1Aap19uhmCNzGwnaUFPbeJ+hFUV7EAAAAAAAAAAgAAAAFFVVIAAAAAAC7C83M2T23Bu4kdQGqdfboZgjcxsJ2lBT23ifoRVFexAAAAADuaygAAAAAAAAAAADuaygAAAAAABAjoBMEUiZNLUjsWXL1iK59D90Li4w56076b8HKxZfIAAAABRVVSAAAAAAAuwvNzNk9twbuJHUBqnX26GYI3MbCdpQU9t4n6EVRXsQAAAAA7msoAAAAAAA==",
			metaXDR:       "AAAAAQAAAAIAAAADAAAAFAAAAAAAAAAA423/rAYjzzhmLqxgNgLUY5X92ueHg5xGtOuok+g5NQoAAAACVAvi1AAAABAAAAACAAAAAQAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAABAAAAFAAAAAAAAAAA423/rAYjzzhmLqxgNgLUY5X92ueHg5xGtOuok+g5NQoAAAACVAvi1AAAABAAAAADAAAAAQAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAABAAAACAAAAAMAAAATAAAAAQAAAAAECOgEwRSJk0tSOxZcvWIrn0P3QuLjDnrTvpvwcrFl8gAAAAFFVVIAAAAAAC7C83M2T23Bu4kdQGqdfboZgjcxsJ2lBT23ifoRVFexAAAAAHc1lAB//////////wAAAAEAAAAAAAAAAAAAAAEAAAAUAAAAAQAAAAAECOgEwRSJk0tSOxZcvWIrn0P3QuLjDnrTvpvwcrFl8gAAAAFFVVIAAAAAAC7C83M2T23Bu4kdQGqdfboZgjcxsJ2lBT23ifoRVFexAAAAALLQXgB//////////wAAAAEAAAAAAAAAAAAAAAMAAAATAAAAAgAAAAAuwvNzNk9twbuJHUBqnX26GYI3MbCdpQU9t4n6EVRXsQAAAAAAAAACAAAAAUVVUgAAAAAALsLzczZPbcG7iR1Aap19uhmCNzGwnaUFPbeJ+hFUV7EAAAAAAAAAADuaygAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAIAAAACAAAAAC7C83M2T23Bu4kdQGqdfboZgjcxsJ2lBT23ifoRVFexAAAAAAAAAAIAAAADAAAAFAAAAAAAAAAA423/rAYjzzhmLqxgNgLUY5X92ueHg5xGtOuok+g5NQoAAAACVAvi1AAAABAAAAADAAAAAQAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAABAAAAFAAAAAAAAAAA423/rAYjzzhmLqxgNgLUY5X92ueHg5xGtOuok+g5NQoAAAACGHEY1AAAABAAAAADAAAAAQAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAADAAAAEwAAAAAAAAAALsLzczZPbcG7iR1Aap19uhmCNzGwnaUFPbeJ+hFUV7EAAAACVAvi1AAAABAAAAADAAAAAgAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAQAAAAA7msoAAAAAAHc1lAAAAAAAAAAAAAAAAAEAAAAUAAAAAAAAAAAuwvNzNk9twbuJHUBqnX26GYI3MbCdpQU9t4n6EVRXsQAAAAKPpqzUAAAAEAAAAAMAAAABAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAABAAAAAAAAAAAAAAAAdzWUAAAAAAAAAAAA",
			feeChangesXDR: "AAAAAgAAAAMAAAATAAAAAAAAAADjbf+sBiPPOGYurGA2AtRjlf3a54eDnEa066iT6Dk1CgAAAAJUC+M4AAAAEAAAAAIAAAABAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAEAAAAUAAAAAAAAAADjbf+sBiPPOGYurGA2AtRjlf3a54eDnEa066iT6Dk1CgAAAAJUC+LUAAAAEAAAAAIAAAABAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA==",
			hash:          "96415ac1d2f79621b26b1568f963fd8dd6c50c20a22c7428cefbfe9dee867588",
			index:         0,
			expected: []xdr.AccountId{
				xdr.MustAddress("GDRW375MAYR46ODGF2WGANQC2RRZL7O246DYHHCGWTV2RE7IHE2QUQLD"),
				xdr.MustAddress("GACAR2AEYEKITE2LKI5RMXF5MIVZ6Q7XILROGDT22O7JX4DSWFS7FDDP"),
			},
		},
		{
			desc:          "manageSellOffer",
			envelopeXDR:   "AAAAAC7C83M2T23Bu4kdQGqdfboZgjcxsJ2lBT23ifoRVFexAAAAZAAAABAAAAACAAAAAAAAAAAAAAABAAAAAAAAAAMAAAAAAAAAAVVTRAAAAAAALsLzczZPbcG7iR1Aap19uhmCNzGwnaUFPbeJ+hFUV7EAAAAA7msoAAAAAAEAAAACAAAAAAAAAAAAAAAAAAAAARFUV7EAAABALuai5QxceFbtAiC5nkntNVnvSPeWR+C+FgplPAdRgRS+PPESpUiSCyuiwuhmvuDw7kwxn+A6E0M4ca1s2qzMAg==",
			resultXDR:     "AAAAAAAAAGQAAAAAAAAAAQAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAC7C83M2T23Bu4kdQGqdfboZgjcxsJ2lBT23ifoRVFexAAAAAAAAAAEAAAAAAAAAAVVTRAAAAAAALsLzczZPbcG7iR1Aap19uhmCNzGwnaUFPbeJ+hFUV7EAAAAA7msoAAAAAAEAAAACAAAAAAAAAAAAAAAA",
			metaXDR:       "AAAAAQAAAAIAAAADAAAAEgAAAAAAAAAALsLzczZPbcG7iR1Aap19uhmCNzGwnaUFPbeJ+hFUV7EAAAACVAvi1AAAABAAAAABAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAABAAAAEgAAAAAAAAAALsLzczZPbcG7iR1Aap19uhmCNzGwnaUFPbeJ+hFUV7EAAAACVAvi1AAAABAAAAACAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAABAAAAAwAAAAMAAAASAAAAAAAAAAAuwvNzNk9twbuJHUBqnX26GYI3MbCdpQU9t4n6EVRXsQAAAAJUC+LUAAAAEAAAAAIAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAEAAAASAAAAAAAAAAAuwvNzNk9twbuJHUBqnX26GYI3MbCdpQU9t4n6EVRXsQAAAAJUC+LUAAAAEAAAAAIAAAABAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAABAAAAAAAAAAAAAAAA7msoAAAAAAAAAAAAAAAAAAAAABIAAAACAAAAAC7C83M2T23Bu4kdQGqdfboZgjcxsJ2lBT23ifoRVFexAAAAAAAAAAEAAAAAAAAAAVVTRAAAAAAALsLzczZPbcG7iR1Aap19uhmCNzGwnaUFPbeJ+hFUV7EAAAAA7msoAAAAAAEAAAACAAAAAAAAAAAAAAAA",
			feeChangesXDR: "AAAAAgAAAAMAAAASAAAAAAAAAAAuwvNzNk9twbuJHUBqnX26GYI3MbCdpQU9t4n6EVRXsQAAAAJUC+OcAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAEAAAASAAAAAAAAAAAuwvNzNk9twbuJHUBqnX26GYI3MbCdpQU9t4n6EVRXsQAAAAJUC+M4AAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA==",
			hash:          "ca756d1519ceda79f8722042b12cea7ba004c3bd961adb62b59f88a867f86eb3",
			index:         0,
			expected: []xdr.AccountId{
				xdr.MustAddress("GAXMF43TGZHW3QN3REOUA2U5PW5BTARXGGYJ3JIFHW3YT6QRKRL3CPPU"),
			},
		},
		{
			desc:          "createPassiveSellOffer",
			envelopeXDR:   "AAAAAHxm7WmlvJxH5BuTz9Qn+PnWcTY9zK8s6YgIjqQyboYYAAAAZAAAABkAAAABAAAAAAAAAAAAAAABAAAAAAAAAAQAAAABVVNEAAAAAAB8Zu1ppbycR+Qbk8/UJ/j51nE2PcyvLOmICI6kMm6GGAAAAAAAAAAAdzWUAAAAAAEAAAABAAAAAAAAAAEyboYYAAAAQBqzCYDuLYn/jXhfEVxEGigMCJGoOBCK92lUb3Um15PgwSJ63tNl+FpH8+y5c+mCs/rzcvdyo9uXdodd4LXWiQg=",
			resultXDR:     "AAAAAAAAAGQAAAAAAAAAAQAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAHxm7WmlvJxH5BuTz9Qn+PnWcTY9zK8s6YgIjqQyboYYAAAAAAAAAAUAAAABVVNEAAAAAAB8Zu1ppbycR+Qbk8/UJ/j51nE2PcyvLOmICI6kMm6GGAAAAAAAAAAAdzWUAAAAAAEAAAABAAAAAQAAAAAAAAAA",
			metaXDR:       "AAAAAQAAAAIAAAADAAAAGgAAAAAAAAAAfGbtaaW8nEfkG5PP1Cf4+dZxNj3MryzpiAiOpDJuhhgAAAACVAvjOAAAABkAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAABAAAAGgAAAAAAAAAAfGbtaaW8nEfkG5PP1Cf4+dZxNj3MryzpiAiOpDJuhhgAAAACVAvjOAAAABkAAAABAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAABAAAAAwAAAAMAAAAaAAAAAAAAAAB8Zu1ppbycR+Qbk8/UJ/j51nE2PcyvLOmICI6kMm6GGAAAAAJUC+M4AAAAGQAAAAEAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAEAAAAaAAAAAAAAAAB8Zu1ppbycR+Qbk8/UJ/j51nE2PcyvLOmICI6kMm6GGAAAAAJUC+M4AAAAGQAAAAEAAAABAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAABAAAAAHc1lAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABoAAAACAAAAAHxm7WmlvJxH5BuTz9Qn+PnWcTY9zK8s6YgIjqQyboYYAAAAAAAAAAUAAAABVVNEAAAAAAB8Zu1ppbycR+Qbk8/UJ/j51nE2PcyvLOmICI6kMm6GGAAAAAAAAAAAdzWUAAAAAAEAAAABAAAAAQAAAAAAAAAA",
			feeChangesXDR: "AAAAAgAAAAMAAAAZAAAAAAAAAAB8Zu1ppbycR+Qbk8/UJ/j51nE2PcyvLOmICI6kMm6GGAAAAAJUC+QAAAAAGQAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAEAAAAaAAAAAAAAAAB8Zu1ppbycR+Qbk8/UJ/j51nE2PcyvLOmICI6kMm6GGAAAAAJUC+OcAAAAGQAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA==",
			hash:          "a76e0260f6b83c6ea93f545d17de721c079dc31e81ee5edc41f159ec5fb48443",
			index:         0,
			expected: []xdr.AccountId{
				xdr.MustAddress("GB6GN3LJUW6JYR7EDOJ47VBH7D45M4JWHXGK6LHJRAEI5JBSN2DBQY7Q"),
			},
		},
		{
			desc:          "setOption",
			envelopeXDR:   "AAAAAJBSxgo7D+SP4ldcjl6iwJjYtL5+AfTMUdled6cwnjBQAAAAZAAAABsAAAAGAAAAAAAAAAAAAAABAAAAAAAAAAUAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAC2V4YW1wbGUuY29tAAAAAAAAAAAAAAAAATCeMFAAAABAkID6CkBHP9eovLQXkMQJ7QkE6NWlmdKGmLxaiI1YaVKZaKJxz5P85x+6wzpYxxbs6Bd2l4qxVjS7Q36DwRiqBA==",
			resultXDR:     "AAAAAAAAAGQAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAA=",
			metaXDR:       "AAAAAQAAAAIAAAADAAAAHAAAAAAAAAAAkFLGCjsP5I/iV1yOXqLAmNi0vn4B9MxR2V53pzCeMFAAAAACVAvhRAAAABsAAAAFAAAAAAAAAAEAAAAAYvwdC9CRsrYcDdZWNGsqaNfTR8bywsjubQRHAlb8BfcAAAADAAAAAAIAAgIAAAAAAAAAAAAAAAAAAAABAAAAHAAAAAAAAAAAkFLGCjsP5I/iV1yOXqLAmNi0vn4B9MxR2V53pzCeMFAAAAACVAvhRAAAABsAAAAGAAAAAAAAAAEAAAAAYvwdC9CRsrYcDdZWNGsqaNfTR8bywsjubQRHAlb8BfcAAAADAAAAAAIAAgIAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAMAAAAcAAAAAAAAAACQUsYKOw/kj+JXXI5eosCY2LS+fgH0zFHZXnenMJ4wUAAAAAJUC+FEAAAAGwAAAAYAAAAAAAAAAQAAAABi/B0L0JGythwN1lY0aypo19NHxvLCyO5tBEcCVvwF9wAAAAMAAAAAAgACAgAAAAAAAAAAAAAAAAAAAAEAAAAcAAAAAAAAAACQUsYKOw/kj+JXXI5eosCY2LS+fgH0zFHZXnenMJ4wUAAAAAJUC+FEAAAAGwAAAAYAAAAAAAAAAQAAAABi/B0L0JGythwN1lY0aypo19NHxvLCyO5tBEcCVvwF9wAAAAMAAAALZXhhbXBsZS5jb20AAgACAgAAAAAAAAAAAAAAAA==",
			feeChangesXDR: "AAAAAgAAAAMAAAAcAAAAAAAAAACQUsYKOw/kj+JXXI5eosCY2LS+fgH0zFHZXnenMJ4wUAAAAAJUC+IMAAAAGwAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAEAAAAcAAAAAAAAAACQUsYKOw/kj+JXXI5eosCY2LS+fgH0zFHZXnenMJ4wUAAAAAJUC+GoAAAAGwAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA==",
			hash:          "8ccc0c28c3e99a63cc59bad7dec3f5c56eb3942c548ecd40bc39c509d6b081d4",
			index:         0,
			expected: []xdr.AccountId{
				xdr.MustAddress("GCIFFRQKHMH6JD7CK5OI4XVCYCMNRNF6PYA7JTCR3FPHPJZQTYYFB5ES"),
			},
		},
		{
			desc:          "changeTrust",
			envelopeXDR:   "AAAAAKturFHJX/eRt5gM6qIXAMbaXvlImqLysA6Qr9tLemxfAAAAZAAAACYAAAABAAAAAAAAAAAAAAABAAAAAAAAAAYAAAABVVNEAAAAAAD5Jjibq+Rf5jsUyQ2/tGzCwiRg0Zd5nj9jARA1Skjz+H//////////AAAAAAAAAAFLemxfAAAAQKN8LftAafeoAGmvpsEokqm47jAuqw4g1UWjmL0j6QPm1jxoalzDwDS3W+N2HOHdjSJlEQaTxGBfQKHhr6nNsAA=",
			resultXDR:     "AAAAAAAAAGQAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAA=",
			metaXDR:       "AAAAAQAAAAIAAAADAAAAKAAAAAAAAAAAq26sUclf95G3mAzqohcAxtpe+UiaovKwDpCv20t6bF8AAAACVAvjOAAAACYAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAABAAAAKAAAAAAAAAAAq26sUclf95G3mAzqohcAxtpe+UiaovKwDpCv20t6bF8AAAACVAvjOAAAACYAAAABAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAABAAAAAwAAAAMAAAAoAAAAAAAAAACrbqxRyV/3kbeYDOqiFwDG2l75SJqi8rAOkK/bS3psXwAAAAJUC+M4AAAAJgAAAAEAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAEAAAAoAAAAAAAAAACrbqxRyV/3kbeYDOqiFwDG2l75SJqi8rAOkK/bS3psXwAAAAJUC+M4AAAAJgAAAAEAAAABAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAoAAAAAQAAAACrbqxRyV/3kbeYDOqiFwDG2l75SJqi8rAOkK/bS3psXwAAAAFVU0QAAAAAAPkmOJur5F/mOxTJDb+0bMLCJGDRl3meP2MBEDVKSPP4AAAAAAAAAAB//////////wAAAAAAAAAAAAAAAA==",
			feeChangesXDR: "AAAAAgAAAAMAAAAmAAAAAAAAAACrbqxRyV/3kbeYDOqiFwDG2l75SJqi8rAOkK/bS3psXwAAAAJUC+QAAAAAJgAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAEAAAAoAAAAAAAAAACrbqxRyV/3kbeYDOqiFwDG2l75SJqi8rAOkK/bS3psXwAAAAJUC+OcAAAAJgAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA==",
			hash:          "6fa467b53f5386d77ad35c2502ed2cd3dd8b460a5be22b6b2818b81bcd3ed2da",
			index:         0,
			expected: []xdr.AccountId{
				xdr.MustAddress("GCVW5LCRZFP7PENXTAGOVIQXADDNUXXZJCNKF4VQB2IK7W2LPJWF73UG"),
			},
		},
		{
			desc:          "allowTrust",
			envelopeXDR:   "AAAAAPkmOJur5F/mOxTJDb+0bMLCJGDRl3meP2MBEDVKSPP4AAAAZAAAACYAAAACAAAAAAAAAAAAAAABAAAAAAAAAAcAAAAAq26sUclf95G3mAzqohcAxtpe+UiaovKwDpCv20t6bF8AAAABVVNEAAAAAAEAAAAAAAAAAUpI8/gAAABA6O2fe1gQBwoO0fMNNEUKH0QdVXVjEWbN5VL51DmRUedYMMXtbX5JKVSzla2kIGvWgls1dXuXHZY/IOlaK01rBQ==",
			resultXDR:     "AAAAAAAAAGQAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAA=",
			metaXDR:       "AAAAAQAAAAIAAAADAAAAKQAAAAAAAAAA+SY4m6vkX+Y7FMkNv7RswsIkYNGXeZ4/YwEQNUpI8/gAAAACVAvi1AAAACYAAAABAAAAAAAAAAAAAAADAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAABAAAAKQAAAAAAAAAA+SY4m6vkX+Y7FMkNv7RswsIkYNGXeZ4/YwEQNUpI8/gAAAACVAvi1AAAACYAAAACAAAAAAAAAAAAAAADAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAMAAAAoAAAAAQAAAACrbqxRyV/3kbeYDOqiFwDG2l75SJqi8rAOkK/bS3psXwAAAAFVU0QAAAAAAPkmOJur5F/mOxTJDb+0bMLCJGDRl3meP2MBEDVKSPP4AAAAAAAAAAB//////////wAAAAAAAAAAAAAAAAAAAAEAAAApAAAAAQAAAACrbqxRyV/3kbeYDOqiFwDG2l75SJqi8rAOkK/bS3psXwAAAAFVU0QAAAAAAPkmOJur5F/mOxTJDb+0bMLCJGDRl3meP2MBEDVKSPP4AAAAAAAAAAB//////////wAAAAEAAAAAAAAAAA==",
			feeChangesXDR: "AAAAAgAAAAMAAAAnAAAAAAAAAAD5Jjibq+Rf5jsUyQ2/tGzCwiRg0Zd5nj9jARA1Skjz+AAAAAJUC+OcAAAAJgAAAAEAAAAAAAAAAAAAAAMAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAEAAAApAAAAAAAAAAD5Jjibq+Rf5jsUyQ2/tGzCwiRg0Zd5nj9jARA1Skjz+AAAAAJUC+M4AAAAJgAAAAEAAAAAAAAAAAAAAAMAAAAAAQAAAAAAAAAAAAAAAAAAAA==",
			hash:          "6d2e30fd57492bf2e2b132e1bc91a548a369189bebf77eb2b3d829121a9d2c50",
			index:         0,
			expected: []xdr.AccountId{
				xdr.MustAddress("GD4SMOE3VPSF7ZR3CTEQ3P5UNTBMEJDA2GLXTHR7MMARANKKJDZ7RPGF"),
				xdr.MustAddress("GCVW5LCRZFP7PENXTAGOVIQXADDNUXXZJCNKF4VQB2IK7W2LPJWF73UG"),
			},
		},
		{
			desc:          "accountMerge (Destination)",
			envelopeXDR:   "AAAAAI77mqNTy9VPgmgn+//uvjP8VJxJ1FHQ4jCrYS+K4+HvAAAAZAAAACsAAAABAAAAAAAAAAAAAAABAAAAAAAAAAgAAAAAYvwdC9CRsrYcDdZWNGsqaNfTR8bywsjubQRHAlb8BfcAAAAAAAAAAYrj4e8AAABA3jJ7wBrRpsrcnqBQWjyzwvVz2v5UJ56G60IhgsaWQFSf+7om462KToc+HJ27aLVOQ83dGh1ivp+VIuREJq/SBw==",
			resultXDR:     "AAAAAAAAAGQAAAAAAAAAAQAAAAAAAAAIAAAAAAAAAAJUC+OcAAAAAA==",
			metaXDR:       "AAAAAQAAAAIAAAADAAAALAAAAAAAAAAAjvuao1PL1U+CaCf7/+6+M/xUnEnUUdDiMKthL4rj4e8AAAACVAvjnAAAACsAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAABAAAALAAAAAAAAAAAjvuao1PL1U+CaCf7/+6+M/xUnEnUUdDiMKthL4rj4e8AAAACVAvjnAAAACsAAAABAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAABAAAABAAAAAMAAAArAAAAAAAAAABi/B0L0JGythwN1lY0aypo19NHxvLCyO5tBEcCVvwF9w3gtonM3Az4AAAAAAAAABIAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAEAAAAsAAAAAAAAAABi/B0L0JGythwN1lY0aypo19NHxvLCyO5tBEcCVvwF9w3gtowg5/CUAAAAAAAAABIAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAMAAAAsAAAAAAAAAACO+5qjU8vVT4JoJ/v/7r4z/FScSdRR0OIwq2EviuPh7wAAAAJUC+OcAAAAKwAAAAEAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAI77mqNTy9VPgmgn+//uvjP8VJxJ1FHQ4jCrYS+K4+Hv",
			feeChangesXDR: "AAAAAgAAAAMAAAArAAAAAAAAAACO+5qjU8vVT4JoJ/v/7r4z/FScSdRR0OIwq2EviuPh7wAAAAJUC+QAAAAAKwAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAEAAAAsAAAAAAAAAACO+5qjU8vVT4JoJ/v/7r4z/FScSdRR0OIwq2EviuPh7wAAAAJUC+OcAAAAKwAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA==",
			hash:          "e0773d07aba23d11e6a06b021682294be1f9f202a2926827022539662ce2c7fc",
			index:         0,
			expected: []xdr.AccountId{
				xdr.MustAddress("GCHPXGVDKPF5KT4CNAT7X77OXYZ7YVE4JHKFDUHCGCVWCL4K4PQ67KKZ"),
				xdr.MustAddress("GBRPYHIL2CI3FNQ4BXLFMNDLFJUNPU2HY3ZMFSHONUCEOASW7QC7OX2H"),
			},
		},
		{
			desc:          "inflation",
			envelopeXDR:   "AAAAAGL8HQvQkbK2HA3WVjRrKmjX00fG8sLI7m0ERwJW/AX3AAAAZAAAAAAAAAAVAAAAAAAAAAAAAAABAAAAAAAAAAkAAAAAAAAAAVb8BfcAAABABUHuXY+MTgW/wDv5+NDVh9fw4meszxeXO98HEQfgXVeCZ7eObCI2orSGUNA/SK6HV9/uTVSxIQQWIso1QoxHBQ==",
			resultXDR:     "AAAAAAAAAGQAAAAAAAAAAQAAAAAAAAAJAAAAAAAAAAIAAAAAYvwdC9CRsrYcDdZWNGsqaNfTR8bywsjubQRHAlb8BfcAAIrEjCYwXAAAAADj3dgEQp1N5U3fBSOCx/nr5XtiCmNJ2oMJZMx+MYK3JwAAIrEjfceLAAAAAA==",
			metaXDR:       "AAAAAQAAAAIAAAADAAAALwAAAAAAAAAAYvwdC9CRsrYcDdZWNGsqaNfTR8bywsjubQRHAlb8BfcLGiubZdPvaAAAAAAAAAAUAAAAAAAAAAEAAAAAYvwdC9CRsrYcDdZWNGsqaNfTR8bywsjubQRHAlb8BfcAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAABAAAALwAAAAAAAAAAYvwdC9CRsrYcDdZWNGsqaNfTR8bywsjubQRHAlb8BfcLGiubZdPvaAAAAAAAAAAVAAAAAAAAAAEAAAAAYvwdC9CRsrYcDdZWNGsqaNfTR8bywsjubQRHAlb8BfcAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAABAAAABAAAAAMAAAAvAAAAAAAAAABi/B0L0JGythwN1lY0aypo19NHxvLCyO5tBEcCVvwF9wsaK5tl0+9oAAAAAAAAABUAAAAAAAAAAQAAAABi/B0L0JGythwN1lY0aypo19NHxvLCyO5tBEcCVvwF9wAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAEAAAAvAAAAAAAAAABi/B0L0JGythwN1lY0aypo19NHxvLCyO5tBEcCVvwF9wsatl/x+h/EAAAAAAAAABUAAAAAAAAAAQAAAABi/B0L0JGythwN1lY0aypo19NHxvLCyO5tBEcCVvwF9wAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAMAAAAuAAAAAAAAAADj3dgEQp1N5U3fBSOCx/nr5XtiCmNJ2oMJZMx+MYK3JwLGivC7E/+cAAAALQAAAAEAAAAAAAAAAQAAAADj3dgEQp1N5U3fBSOCx/nr5XtiCmNJ2oMJZMx+MYK3JwAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAEAAAAvAAAAAAAAAADj3dgEQp1N5U3fBSOCx/nr5XtiCmNJ2oMJZMx+MYK3JwLGraHekccnAAAALQAAAAEAAAAAAAAAAQAAAADj3dgEQp1N5U3fBSOCx/nr5XtiCmNJ2oMJZMx+MYK3JwAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA==",
			feeChangesXDR: "AAAAAgAAAAMAAAAuAAAAAAAAAABi/B0L0JGythwN1lY0aypo19NHxvLCyO5tBEcCVvwF9wsaK5tl0+/MAAAAAAAAABQAAAAAAAAAAQAAAABi/B0L0JGythwN1lY0aypo19NHxvLCyO5tBEcCVvwF9wAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAEAAAAvAAAAAAAAAABi/B0L0JGythwN1lY0aypo19NHxvLCyO5tBEcCVvwF9wsaK5tl0+9oAAAAAAAAABQAAAAAAAAAAQAAAABi/B0L0JGythwN1lY0aypo19NHxvLCyO5tBEcCVvwF9wAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA==",
			hash:          "ea93efd8c2f4e45c0318c69ec958623a0e4374f40d569eec124d43c8a54d6256",
			index:         0,
			expected: []xdr.AccountId{
				xdr.MustAddress("GBRPYHIL2CI3FNQ4BXLFMNDLFJUNPU2HY3ZMFSHONUCEOASW7QC7OX2H"),
			},
		},
		{
			desc:        "manageData",
			envelopeXDR: "AAAAADEhMVDHiYXdz5z8l73XGyrQ2RN85ZRW1uLsCNQumfsZAAAAZAAAADAAAAACAAAAAAAAAAAAAAABAAAAAAAAAAoAAAAFbmFtZTIAAAAAAAABAAAABDU2NzgAAAAAAAAAAS6Z+xkAAABAjxgnTRBCa0n1efZocxpEjXeITQ5sEYTVd9fowuto2kPw5eFwgVnz6OrKJwCRt5L8ylmWiATXVI3Zyfi3yTKqBA==",

			resultXDR:     "AAAAAAAAAGQAAAAAAAAAAQAAAAAAAAAKAAAAAAAAAAA=",
			metaXDR:       "AAAAAQAAAAIAAAADAAAAMQAAAAAAAAAAMSExUMeJhd3PnPyXvdcbKtDZE3zllFbW4uwI1C6Z+xkAAAACVAvi1AAAADAAAAABAAAAAQAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAABAAAAMQAAAAAAAAAAMSExUMeJhd3PnPyXvdcbKtDZE3zllFbW4uwI1C6Z+xkAAAACVAvi1AAAADAAAAACAAAAAQAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAABAAAAAwAAAAMAAAAxAAAAAAAAAAAxITFQx4mF3c+c/Je91xsq0NkTfOWUVtbi7AjULpn7GQAAAAJUC+LUAAAAMAAAAAIAAAABAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAEAAAAxAAAAAAAAAAAxITFQx4mF3c+c/Je91xsq0NkTfOWUVtbi7AjULpn7GQAAAAJUC+LUAAAAMAAAAAIAAAACAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAxAAAAAwAAAAAxITFQx4mF3c+c/Je91xsq0NkTfOWUVtbi7AjULpn7GQAAAAVuYW1lMgAAAAAAAAQ1Njc4AAAAAAAAAAA=",
			feeChangesXDR: "AAAAAgAAAAMAAAAxAAAAAAAAAAAxITFQx4mF3c+c/Je91xsq0NkTfOWUVtbi7AjULpn7GQAAAAJUC+OcAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAEAAAAxAAAAAAAAAAAxITFQx4mF3c+c/Je91xsq0NkTfOWUVtbi7AjULpn7GQAAAAJUC+M4AAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA==",
			hash:          "e4609180751e7702466a8845857df43e4d154ec84b6bad62ce507fe12f1daf99",
			index:         0,
			expected: []xdr.AccountId{
				xdr.MustAddress("GAYSCMKQY6EYLXOPTT6JPPOXDMVNBWITPTSZIVWW4LWARVBOTH5RTLAD"),
			},
		},
		{
			desc:        "bumpSequence",
			envelopeXDR: "AAAAAKGX7RT96eIn205uoUHYnqLbt2cPRNORraEoeTAcrRKUAAAAZAAAAEXZZLgDAAAAAAAAAAAAAAABAAAAAAAAAAsAAABF2WS4AwAAAAAAAAABHK0SlAAAAECcI6ex0Dq6YAh6aK14jHxuAvhvKG2+NuzboAKrfYCaC1ZSQ77BYH/5MghPX97JO9WXV17ehNK7d0umxBgaJj8A",

			resultXDR:     "AAAAAAAAAGQAAAAAAAAAAQAAAAAAAAALAAAAAAAAAAA=",
			metaXDR:       "AAAAAQAAAAIAAAADAAAAPQAAAAAAAAAAoZftFP3p4ifbTm6hQdieotu3Zw9E05GtoSh5MBytEpQAAAACVAvicAAAAEXZZLgCAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAABAAAAPQAAAAAAAAAAoZftFP3p4ifbTm6hQdieotu3Zw9E05GtoSh5MBytEpQAAAACVAvicAAAAEXZZLgDAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAABAAAAAA==",
			feeChangesXDR: "AAAAAgAAAAMAAAA8AAAAAAAAAAChl+0U/eniJ9tObqFB2J6i27dnD0TTka2hKHkwHK0SlAAAAAJUC+LUAAAARdlkuAIAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAEAAAA9AAAAAAAAAAChl+0U/eniJ9tObqFB2J6i27dnD0TTka2hKHkwHK0SlAAAAAJUC+JwAAAARdlkuAIAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA==",
			hash:          "bc11b5c41de791369fd85fa1ccf01c35c20df5f98ff2f75d02ead61bfd520e21",
			index:         0,
			expected: []xdr.AccountId{
				xdr.MustAddress("GCQZP3IU7XU6EJ63JZXKCQOYT2RNXN3HB5CNHENNUEUHSMA4VUJJJSEN"),
			},
		},
		{
			desc:          "manageBuyOffer",
			envelopeXDR:   "AAAAAJ/0uhpjIPNaeEcEqBy5SVquaG77leHg6iNYV67vrxFhAAAAZAAFedEAAAAQAAAAAQAAAAAAAAAAAAAAAF3cTA8AAAABAAAADk1ha2UgQnV5IE9mZmVyAAAAAAABAAAAAAAAAAwAAAABWENaAAAAAAC0GeXnSSrjPt5iaVo8DbLiZW0sHr2WP9zMWYuGMrdEhQAAAAAAAAAANZresAAAAAgAAAABAAAAAAAAAAAAAAAAAAAAAe+vEWEAAABAY0cI3kQXv1EcCDDmf3hCKLLEiinkVPB2+rAJe8PnA8WY8r27xGr5LCikUj8n7wEAtzMM83VcPYIMoJROYMjvCA==",
			resultXDR:     "AAAAAAAAAGQAAAAAAAAAAQAAAAAAAAAMAAAAAAAAAAIAAAAAs/VGFE8UPc+joxmES67/oVFj3tKJVdCzBqJoIsmWHmkAAAAAAEPjtgAAAAAAAAAAL3ix2AAAAAFYQ1oAAAAAALQZ5edJKuM+3mJpWjwNsuJlbSwevZY/3MxZi4Yyt0SFAAAAAAXvFjsAAAAAgFKhklnQv7X44QJm0yDkmvjtZFHs+O65cfO+EhWwOdQAAAAAAEPkBgAAAAAAAAAABiIs2AAAAAFYQ1oAAAAAALQZ5edJKuM+3mJpWjwNsuJlbSwevZY/3MxZi4Yyt0SFAAAAAADERZsAAAACAAAAAA==",
			metaXDR:       "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",
			feeChangesXDR: "AAAAAgAAAAMABjMvAAAAAAAAAACf9LoaYyDzWnhHBKgcuUlarmhu+5Xh4OojWFeu768RYQAAABdgScMrAAV50QAAAA8AAAAEAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAABAAAAAAAAAAAAAAAAHtE0uAAAAAAAAAAAAAAAAQAGaD0AAAAAAAAAAJ/0uhpjIPNaeEcEqBy5SVquaG77leHg6iNYV67vrxFhAAAAF2BJwscABXnRAAAADwAAAAQAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAe0TS4AAAAAAAAAAA=",
			hash:          "94b050b55dfdfa55dc46889b6f6b5798c24cf77983562826a74db058ff0eb5b4",
			index:         0,
			expected: []xdr.AccountId{
				xdr.MustAddress("GCP7JOQ2MMQPGWTYI4CKQHFZJFNK42DO7OK6DYHKENMFPLXPV4IWDPLC"),
			},
		},
		{
			desc:          "pathPaymentStrictSend",
			envelopeXDR:   "AAAAAOsC3UuQJXeJWl7o2Q9Wf2RvZiHiHKfSbtDNsXkn3NMiAAAAZAAKTgQAAAABAAAAAAAAAAAAAAABAAAAAAAAAA0AAAAAAAAAAAX14QAAAAAA4VWYSXp7+QFjS8+8WzU2KJTONKIIk2FHXORcby4KqbgAAAAAAAAAAAX14QAAAAABAAAAAAAAAAAAAAABJ9zTIgAAAEBPAPVBKa8d5/DyiTghHO8OnFNtxa4WSMW1geqCH+83EL+yyLszkzdIWSBX8/N9FC1Mo+DTRF/peVAsxlL4G04N",
			resultXDR:     "AAAAAAAAAGQAAAAAAAAAAQAAAAAAAAANAAAAAAAAAAAAAAAA4VWYSXp7+QFjS8+8WzU2KJTONKIIk2FHXORcby4KqbgAAAAAAAAAAAX14QAAAAAA",
			metaXDR:       "AAAAAQAAAAIAAAADAApOFQAAAAAAAAAA6wLdS5Ald4laXujZD1Z/ZG9mIeIcp9Ju0M2xeSfc0yIAAAAXSHbnnAAKTgQAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAABAApOFQAAAAAAAAAA6wLdS5Ald4laXujZD1Z/ZG9mIeIcp9Ju0M2xeSfc0yIAAAAXSHbnnAAKTgQAAAABAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAABAAAABAAAAAMACk4VAAAAAAAAAADrAt1LkCV3iVpe6NkPVn9kb2Yh4hyn0m7QzbF5J9zTIgAAABdIduecAApOBAAAAAEAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAEACk4VAAAAAAAAAADrAt1LkCV3iVpe6NkPVn9kb2Yh4hyn0m7QzbF5J9zTIgAAABdCgQacAApOBAAAAAEAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAMABZwuAAAAAAAAAADhVZhJenv5AWNLz7xbNTYolM40ogiTYUdc5FxvLgqpuAAAAAAAmJaAAAWcLgAAAAAAAAAAAAAAAAAAAAQAAAARdHN0LnRlc3Rhc3NldC5jb20AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAKThUAAAAAAAAAAOFVmEl6e/kBY0vPvFs1NiiUzjSiCJNhR1zkXG8uCqm4AAAAAAaOd4AABZwuAAAAAAAAAAAAAAAAAAAABAAAABF0c3QudGVzdGFzc2V0LmNvbQAAAAAAAAAAAAAAAAAAAAAAAAA=",
			feeChangesXDR: "AAAAAgAAAAMACk4EAAAAAAAAAADrAt1LkCV3iVpe6NkPVn9kb2Yh4hyn0m7QzbF5J9zTIgAAABdIdugAAApOBAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAEACk4VAAAAAAAAAADrAt1LkCV3iVpe6NkPVn9kb2Yh4hyn0m7QzbF5J9zTIgAAABdIduecAApOBAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA==",
			hash:          "5cbb2e13e2ddd72075b6c7e83eb018d0092c27972bf1f0343b83be9c5f964b62",
			index:         0,
			expected: []xdr.AccountId{
				xdr.MustAddress("GDVQFXKLSASXPCK2L3UNSD2WP5SG6ZRB4IOKPUTO2DG3C6JH3TJSEA7R"),
				xdr.MustAddress("GDQVLGCJPJ57SALDJPH3YWZVGYUJJTRUUIEJGYKHLTSFY3ZOBKU3QIO3"),
			},
		},
		{
			desc:          "operation with source_account different to transaction source_account",
			envelopeXDR:   "AAAAAOZPoQTlXBixd6XSUExX/Yvos/pVllkUNdNvCdmC+mNkAAACvAAE5bIAAAAOAAAAAQAAAAAAAAAAAAAAAF3X8mwAAAAAAAAABwAAAAEAAAAA5k+hBOVcGLF3pdJQTFf9i+iz+lWWWRQ1028J2YL6Y2QAAAAAAAAAAPEmrGI5+i9IbPyf3l+6kVhML1lUZJJmyQvdBRccfZkgAAAAAACYloAAAAABAAAAAOZPoQTlXBixd6XSUExX/Yvos/pVllkUNdNvCdmC+mNkAAAAAAAAAAD66ofFUOv3/k5PaB0F6wr5c0jvwdDY933ssbjK656DmwAAAAAF9eEAAAAAAQAAAAD66ofFUOv3/k5PaB0F6wr5c0jvwdDY933ssbjK656DmwAAAAYAAAABVFNUAAAAAADxJqxiOfovSGz8n95fupFYTC9ZVGSSZskL3QUXHH2ZIAAAAAB3NZQAAAAAAQAAAADxJqxiOfovSGz8n95fupFYTC9ZVGSSZskL3QUXHH2ZIAAAAAEAAAAA+uqHxVDr9/5OT2gdBesK+XNI78HQ2Pd97LG4yuueg5sAAAABVFNUAAAAAADxJqxiOfovSGz8n95fupFYTC9ZVGSSZskL3QUXHH2ZIAAAAAB3NZQAAAAAAQAAAADxJqxiOfovSGz8n95fupFYTC9ZVGSSZskL3QUXHH2ZIAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAABF0c3QudGVzdGFzc2V0LmNvbQAAAAAAAAAAAAABAAAAAPEmrGI5+i9IbPyf3l+6kVhML1lUZJJmyQvdBRccfZkgAAAABQAAAAAAAAAAAAAAAQAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAPEmrGI5+i9IbPyf3l+6kVhML1lUZJJmyQvdBRccfZkgAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4L6Y2QAAABAd8d0e8OiMmmGlxLrPu8JfTLphUfFPgx0Fs/fwU6/ilzwbpTHCKICWGlSz8enjb57FXD6DliXcaWJeR/2Fj8tB+ueg5sAAABAkAwqpu1liQpxh3C2MdsDoOg/N4pxuUuzh0Ey/0g0QbWy0Y2bBkLPldsGj/pDNbKfkZPGfdx4MZ6rHbUdGEwgDRx9mSAAAABA/IRS0D7EcFS1J6uR4HnOvh8tikBhVe+0uI6DPkqv/GfSqeuoZIRyWxKSd/v64DxxozKZsmQmatLZqOnQwkuxCA==",
			resultXDR:     "AAAAAAAAArwAAAAAAAAABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAAAAAAAAA=",
			metaXDR:       "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",
			feeChangesXDR: "AAAAAgAAAAMABZv0AAAAAAAAAADmT6EE5VwYsXel0lBMV/2L6LP6VZZZFDXTbwnZgvpjZAAAABbjItzUAATlsgAAAA0AAAAAAAAAAAAAAAEAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAEABZwAAAAAAAAAAADmT6EE5VwYsXel0lBMV/2L6LP6VZZZFDXTbwnZgvpjZAAAABbjItoYAATlsgAAAA0AAAAAAAAAAAAAAAEAAAAAAQAAAAAAAAAAAAAAAAAAAA==",
			hash:          "12e901c3c12cc9f35adc09e83c0a2d58f939e8c0bebc6f9a945aea42f2587cfe",
			index:         2,
			expected: []xdr.AccountId{
				xdr.MustAddress("GD5OVB6FKDV7P7SOJ5UB2BPLBL4XGSHPYHINR5355SY3RSXLT2BZWAKY"),
			},
		},
		{
			desc:          "revokeSponsorship (signer)",
			envelopeXDR:   "AAAAAgAAAAAokk0ZqR+mxwuhJJ2uXvNqIhmObygxBFIJKvQgf/7fqwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAASAAAAAQAAAAA7YL8A7jlgEPe0dUU7VHcDQx6Q/wlHqc3UD15aJ3Ii1QAAAACCEcFim0Esp2yagOwR1omkcZQJqj9X5o5/1XafEdnfoAAAAAAAAAAA",
			resultXDR:     "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
			metaXDR:       "AAAAAgAAAAAAAAABAAAAAAAAAAA=",
			feeChangesXDR: "AAAAAA==",
			hash:          "a41d1c8cdf515203ac5a10d945d5023325076b23dbe7d65ae402cd5f8cd9f891",
			index:         0,
			expected: []xdr.AccountId{
				xdr.MustAddress("GAUJETIZVEP2NRYLUESJ3LS66NVCEGMON4UDCBCSBEVPIID773P2W6AY"),
				xdr.MustAddress("GA5WBPYA5Y4WAEHXWR2UKO2UO4BUGHUQ74EUPKON2QHV4WRHOIRNKKH2"),
			},
		},
		{
			desc:          "revokeSponsorship (ledger key)",
			envelopeXDR:   "AAAAAgAAAAAokk0ZqR+mxwuhJJ2uXvNqIhmObygxBFIJKvQgf/7fqwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAASAAAAAAAAAAQAAAAAyv66vgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==",
			resultXDR:     "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
			metaXDR:       "AAAAAgAAAAAAAAABAAAAAAAAAAA=",
			feeChangesXDR: "AAAAAA==",
			hash:          "13658aed93a0cb60582491a8eb945eb9b7737a7560324dd2b24f2acfe5090ada",
			index:         0,
			expected: []xdr.AccountId{
				xdr.MustAddress("GAUJETIZVEP2NRYLUESJ3LS66NVCEGMON4UDCBCSBEVPIID773P2W6AY"),
			},
		},
	}
	for _, tc := range testCases {
		t.Run(tc.desc, func(t *testing.T) {
			tt := assert.New(t)
			transaction := BuildLedgerTransaction(
				t,
				TestTransaction{
					Index:         1,
					EnvelopeXDR:   tc.envelopeXDR,
					ResultXDR:     tc.resultXDR,
					MetaXDR:       tc.metaXDR,
					FeeChangesXDR: tc.feeChangesXDR,
					Hash:          tc.hash,
				},
			)

			operation := transactionOperationWrapper{
				index:          tc.index,
				transaction:    transaction,
				operation:      transaction.Envelope.Operations()[tc.index],
				ledgerSequence: 1,
			}

			participants, err := operation.Participants()
			tt.NoError(err)
			tt.ElementsMatch(tc.expected, participants)
		})
	}
}

func TestOperationParticipants(t *testing.T) {
	tt := assert.New(t)

	sequence := uint32(56)
	transaction := BuildLedgerTransaction(
		t,
		TestTransaction{
			Index:         1,
			EnvelopeXDR:   "AAAAAONt/6wGI884Zi6sYDYC1GOV/drnh4OcRrTrqJPoOTUKAAAAZAAAABAAAAADAAAAAAAAAAAAAAABAAAAAAAAAAIAAAAAAAAAADuaygAAAAAABAjoBMEUiZNLUjsWXL1iK59D90Li4w56076b8HKxZfIAAAABRVVSAAAAAAAuwvNzNk9twbuJHUBqnX26GYI3MbCdpQU9t4n6EVRXsQAAAAA7msoAAAAAAAAAAAAAAAAB6Dk1CgAAAEB+7jxesBKKrF343onyycjp2tiQLZiGH2ETl+9fuOqotveY2rIgvt9ng+QJ2aDP3+PnDsYEa9ZUaA+Zne2nIGgE",
			ResultXDR:     "AAAAAAAAAGQAAAAAAAAAAQAAAAAAAAACAAAAAAAAAAEAAAAALsLzczZPbcG7iR1Aap19uhmCNzGwnaUFPbeJ+hFUV7EAAAAAAAAAAgAAAAFFVVIAAAAAAC7C83M2T23Bu4kdQGqdfboZgjcxsJ2lBT23ifoRVFexAAAAADuaygAAAAAAAAAAADuaygAAAAAABAjoBMEUiZNLUjsWXL1iK59D90Li4w56076b8HKxZfIAAAABRVVSAAAAAAAuwvNzNk9twbuJHUBqnX26GYI3MbCdpQU9t4n6EVRXsQAAAAA7msoAAAAAAA==",
			MetaXDR:       "AAAAAQAAAAIAAAADAAAAFAAAAAAAAAAA423/rAYjzzhmLqxgNgLUY5X92ueHg5xGtOuok+g5NQoAAAACVAvi1AAAABAAAAACAAAAAQAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAABAAAAFAAAAAAAAAAA423/rAYjzzhmLqxgNgLUY5X92ueHg5xGtOuok+g5NQoAAAACVAvi1AAAABAAAAADAAAAAQAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAABAAAACAAAAAMAAAATAAAAAQAAAAAECOgEwRSJk0tSOxZcvWIrn0P3QuLjDnrTvpvwcrFl8gAAAAFFVVIAAAAAAC7C83M2T23Bu4kdQGqdfboZgjcxsJ2lBT23ifoRVFexAAAAAHc1lAB//////////wAAAAEAAAAAAAAAAAAAAAEAAAAUAAAAAQAAAAAECOgEwRSJk0tSOxZcvWIrn0P3QuLjDnrTvpvwcrFl8gAAAAFFVVIAAAAAAC7C83M2T23Bu4kdQGqdfboZgjcxsJ2lBT23ifoRVFexAAAAALLQXgB//////////wAAAAEAAAAAAAAAAAAAAAMAAAATAAAAAgAAAAAuwvNzNk9twbuJHUBqnX26GYI3MbCdpQU9t4n6EVRXsQAAAAAAAAACAAAAAUVVUgAAAAAALsLzczZPbcG7iR1Aap19uhmCNzGwnaUFPbeJ+hFUV7EAAAAAAAAAADuaygAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAIAAAACAAAAAC7C83M2T23Bu4kdQGqdfboZgjcxsJ2lBT23ifoRVFexAAAAAAAAAAIAAAADAAAAFAAAAAAAAAAA423/rAYjzzhmLqxgNgLUY5X92ueHg5xGtOuok+g5NQoAAAACVAvi1AAAABAAAAADAAAAAQAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAABAAAAFAAAAAAAAAAA423/rAYjzzhmLqxgNgLUY5X92ueHg5xGtOuok+g5NQoAAAACGHEY1AAAABAAAAADAAAAAQAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAADAAAAEwAAAAAAAAAALsLzczZPbcG7iR1Aap19uhmCNzGwnaUFPbeJ+hFUV7EAAAACVAvi1AAAABAAAAADAAAAAgAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAQAAAAA7msoAAAAAAHc1lAAAAAAAAAAAAAAAAAEAAAAUAAAAAAAAAAAuwvNzNk9twbuJHUBqnX26GYI3MbCdpQU9t4n6EVRXsQAAAAKPpqzUAAAAEAAAAAMAAAABAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAABAAAAAAAAAAAAAAAAdzWUAAAAAAAAAAAA",
			FeeChangesXDR: "AAAAAgAAAAMAAAATAAAAAAAAAADjbf+sBiPPOGYurGA2AtRjlf3a54eDnEa066iT6Dk1CgAAAAJUC+M4AAAAEAAAAAIAAAABAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAEAAAAUAAAAAAAAAADjbf+sBiPPOGYurGA2AtRjlf3a54eDnEa066iT6Dk1CgAAAAJUC+LUAAAAEAAAAAIAAAABAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA==",
			Hash:          "96415ac1d2f79621b26b1568f963fd8dd6c50c20a22c7428cefbfe9dee867588",
		},
	)

	expectedParticipants := []xdr.AccountId{
		xdr.MustAddress("GDRW375MAYR46ODGF2WGANQC2RRZL7O246DYHHCGWTV2RE7IHE2QUQLD"),
		xdr.MustAddress("GACAR2AEYEKITE2LKI5RMXF5MIVZ6Q7XILROGDT22O7JX4DSWFS7FDDP"),
	}
	participantsMap, err := operationsParticipants(transaction, sequence)
	tt.NoError(err)
	tt.Len(participantsMap, 1)
	for k, v := range participantsMap {
		tt.Equal(int64(240518172673), k)
		tt.ElementsMatch(expectedParticipants, v)
	}
}

func TestTransactionOperationAllowTrustDetails(t *testing.T) {
	tt := assert.New(t)
	asset := xdr.Asset{}
	allowTrustAsset, err := asset.ToAssetCode("COP")
	tt.NoError(err)

	aid := xdr.MustAddress("GDRW375MAYR46ODGF2WGANQC2RRZL7O246DYHHCGWTV2RE7IHE2QUQLD")
	source := aid.ToMuxedAccount()

	testCases := []struct {
		desc     string
		op       xdr.Operation
		expected map[string]interface{}
	}{
		{
			desc: "authorize",
			op: xdr.Operation{
				SourceAccount: &source,
				Body: xdr.OperationBody{
					Type: xdr.OperationTypeAllowTrust,
					AllowTrustOp: &xdr.AllowTrustOp{
						Trustor:   xdr.MustAddress("GDQNY3PBOJOKYZSRMK2S7LHHGWZIUISD4QORETLMXEWXBI7KFZZMKTL3"),
						Asset:     allowTrustAsset,
						Authorize: xdr.Uint32(xdr.TrustLineFlagsAuthorizedFlag),
					},
				},
			},
			expected: map[string]interface{}{
				"asset_code":   "COP",
				"asset_issuer": "GDRW375MAYR46ODGF2WGANQC2RRZL7O246DYHHCGWTV2RE7IHE2QUQLD",
				"asset_type":   "credit_alphanum4",
				"authorize":    true,
				"trustee":      "GDRW375MAYR46ODGF2WGANQC2RRZL7O246DYHHCGWTV2RE7IHE2QUQLD",
				"trustor":      "GDQNY3PBOJOKYZSRMK2S7LHHGWZIUISD4QORETLMXEWXBI7KFZZMKTL3",
			},
		},
		{
			desc: "authorize maintain liabilities",
			op: xdr.Operation{
				SourceAccount: &source,
				Body: xdr.OperationBody{
					Type: xdr.OperationTypeAllowTrust,
					AllowTrustOp: &xdr.AllowTrustOp{
						Trustor:   xdr.MustAddress("GDQNY3PBOJOKYZSRMK2S7LHHGWZIUISD4QORETLMXEWXBI7KFZZMKTL3"),
						Asset:     allowTrustAsset,
						Authorize: xdr.Uint32(xdr.TrustLineFlagsAuthorizedToMaintainLiabilitiesFlag),
					},
				},
			},
			expected: map[string]interface{}{
				"asset_code":                        "COP",
				"asset_issuer":                      "GDRW375MAYR46ODGF2WGANQC2RRZL7O246DYHHCGWTV2RE7IHE2QUQLD",
				"asset_type":                        "credit_alphanum4",
				"authorize":                         false,
				"authorize_to_maintain_liabilities": true,
				"trustee":                           "GDRW375MAYR46ODGF2WGANQC2RRZL7O246DYHHCGWTV2RE7IHE2QUQLD",
				"trustor":                           "GDQNY3PBOJOKYZSRMK2S7LHHGWZIUISD4QORETLMXEWXBI7KFZZMKTL3",
			},
		},
		{
			desc: "deauthorize",
			op: xdr.Operation{
				SourceAccount: &source,
				Body: xdr.OperationBody{
					Type: xdr.OperationTypeAllowTrust,
					AllowTrustOp: &xdr.AllowTrustOp{
						Trustor:   xdr.MustAddress("GDQNY3PBOJOKYZSRMK2S7LHHGWZIUISD4QORETLMXEWXBI7KFZZMKTL3"),
						Asset:     allowTrustAsset,
						Authorize: xdr.Uint32(0),
					},
				},
			},
			expected: map[string]interface{}{
				"asset_code":   "COP",
				"asset_issuer": "GDRW375MAYR46ODGF2WGANQC2RRZL7O246DYHHCGWTV2RE7IHE2QUQLD",
				"asset_type":   "credit_alphanum4",
				"authorize":    false,
				"trustee":      "GDRW375MAYR46ODGF2WGANQC2RRZL7O246DYHHCGWTV2RE7IHE2QUQLD",
				"trustor":      "GDQNY3PBOJOKYZSRMK2S7LHHGWZIUISD4QORETLMXEWXBI7KFZZMKTL3",
			},
		},
	}
	for _, tc := range testCases {
		t.Run(tc.desc, func(t *testing.T) {
			operation := transactionOperationWrapper{
				index: 0,
				transaction: ingest.LedgerTransaction{
					Meta: xdr.TransactionMeta{
						V: 2,
						V2: &xdr.TransactionMetaV2{
							Operations: make([]xdr.OperationMeta, 1, 1),
						},
					},
				},
				operation:      tc.op,
				ledgerSequence: 1,
			}
			details, err := operation.Details()
			tt.NoError(err)
			tt.Equal(tc.expected, details)
		})
	}
}

type CreateClaimableBalanceOpTestSuite struct {
	suite.Suite
	ops []xdr.Operation
}

func (s *CreateClaimableBalanceOpTestSuite) SetupTest() {
	aid := xdr.MustAddress("GDRW375MAYR46ODGF2WGANQC2RRZL7O246DYHHCGWTV2RE7IHE2QUQLD")
	source := aid.ToMuxedAccount()
	s.ops = []xdr.Operation{
		{
			SourceAccount: &source,
			Body: xdr.OperationBody{
				Type: xdr.OperationTypeCreateClaimableBalance,
				CreateClaimableBalanceOp: &xdr.CreateClaimableBalanceOp{
					Amount: xdr.Int64(100000000),
					Asset:  xdr.MustNewNativeAsset(),
					Claimants: []xdr.Claimant{
						{
							Type: xdr.ClaimantTypeClaimantTypeV0,
							V0: &xdr.ClaimantV0{
								Destination: xdr.MustAddress("GD5OVB6FKDV7P7SOJ5UB2BPLBL4XGSHPYHINR5355SY3RSXLT2BZWAKY"),

								Predicate: xdr.ClaimPredicate{
									Type: xdr.ClaimPredicateTypeClaimPredicateUnconditional,
								},
							},
						},
					},
				},
			},
		},
		{
			SourceAccount: &source,
			Body: xdr.OperationBody{
				Type: xdr.OperationTypeCreateClaimableBalance,
				CreateClaimableBalanceOp: &xdr.CreateClaimableBalanceOp{
					Amount: xdr.Int64(200000000),
					Asset:  xdr.MustNewCreditAsset("USD", "GDRW375MAYR46ODGF2WGANQC2RRZL7O246DYHHCGWTV2RE7IHE2QUQLD"),
					Claimants: []xdr.Claimant{
						{
							Type: xdr.ClaimantTypeClaimantTypeV0,
							V0: &xdr.ClaimantV0{
								Destination: xdr.MustAddress("GDMQUXK7ZUCWM5472ZU3YLDP4BMJLQQ76DEMNYDEY2ODEEGGRKLEWGW2"),
								Predicate: xdr.ClaimPredicate{
									Type: xdr.ClaimPredicateTypeClaimPredicateUnconditional,
								},
							},
						},
						{
							Type: xdr.ClaimantTypeClaimantTypeV0,
							V0: &xdr.ClaimantV0{
								Destination: xdr.MustAddress("GDQNY3PBOJOKYZSRMK2S7LHHGWZIUISD4QORETLMXEWXBI7KFZZMKTL3"),
								Predicate: xdr.ClaimPredicate{
									Type: xdr.ClaimPredicateTypeClaimPredicateUnconditional,
								},
							},
						},
					},
				},
			},
		},
	}
}
func (s *CreateClaimableBalanceOpTestSuite) TestDetails() {
	testCases := []struct {
		desc     string
		op       xdr.Operation
		expected map[string]interface{}
	}{
		{
			desc: "claimable balance with native asset",
			op:   s.ops[0],
			expected: map[string]interface{}{
				"asset":  "native",
				"amount": "10.0000000",
				"claimants": history.Claimants{
					history.Claimant{
						Destination: "GD5OVB6FKDV7P7SOJ5UB2BPLBL4XGSHPYHINR5355SY3RSXLT2BZWAKY",
						Predicate: xdr.ClaimPredicate{
							Type: xdr.ClaimPredicateTypeClaimPredicateUnconditional,
						},
					},
				},
			},
		},
		{
			desc: "claimable balance with issued asset",
			op:   s.ops[1],
			expected: map[string]interface{}{
				"asset":  "USD:GDRW375MAYR46ODGF2WGANQC2RRZL7O246DYHHCGWTV2RE7IHE2QUQLD",
				"amount": "20.0000000",
				"claimants": history.Claimants{
					history.Claimant{
						Destination: "GDMQUXK7ZUCWM5472ZU3YLDP4BMJLQQ76DEMNYDEY2ODEEGGRKLEWGW2",
						Predicate: xdr.ClaimPredicate{
							Type: xdr.ClaimPredicateTypeClaimPredicateUnconditional,
						},
					},
					history.Claimant{
						Destination: "GDQNY3PBOJOKYZSRMK2S7LHHGWZIUISD4QORETLMXEWXBI7KFZZMKTL3",
						Predicate: xdr.ClaimPredicate{
							Type: xdr.ClaimPredicateTypeClaimPredicateUnconditional,
						},
					},
				},
			},
		},
	}
	for _, tc := range testCases {
		s.T().Run(tc.desc, func(t *testing.T) {
			operation := transactionOperationWrapper{
				index: 0,
				transaction: ingest.LedgerTransaction{
					Meta: xdr.TransactionMeta{
						V: 2,
						V2: &xdr.TransactionMetaV2{
							Operations: make([]xdr.OperationMeta, 1, 1),
						},
					},
				},
				operation:      tc.op,
				ledgerSequence: 1,
			}

			details, err := operation.Details()
			s.Assert().NoError(err)
			s.Assert().Equal(tc.expected, details)
		})
	}
}

func (s *CreateClaimableBalanceOpTestSuite) TestParticipants() {
	testCases := []struct {
		desc     string
		op       xdr.Operation
		expected []xdr.AccountId
	}{
		{
			desc: "claimable balance with a single claimant",
			op:   s.ops[0],
			expected: []xdr.AccountId{
				xdr.MustAddress("GDRW375MAYR46ODGF2WGANQC2RRZL7O246DYHHCGWTV2RE7IHE2QUQLD"),
				xdr.MustAddress("GD5OVB6FKDV7P7SOJ5UB2BPLBL4XGSHPYHINR5355SY3RSXLT2BZWAKY"),
			},
		},
		{
			desc: "claimable balance with a multiple claimants",
			op:   s.ops[1],
			expected: []xdr.AccountId{
				xdr.MustAddress("GDRW375MAYR46ODGF2WGANQC2RRZL7O246DYHHCGWTV2RE7IHE2QUQLD"),
				xdr.MustAddress("GDMQUXK7ZUCWM5472ZU3YLDP4BMJLQQ76DEMNYDEY2ODEEGGRKLEWGW2"),
				xdr.MustAddress("GDQNY3PBOJOKYZSRMK2S7LHHGWZIUISD4QORETLMXEWXBI7KFZZMKTL3"),
			},
		},
	}
	for _, tc := range testCases {
		s.T().Run(tc.desc, func(t *testing.T) {
			operation := transactionOperationWrapper{
				index: 0,
				transaction: ingest.LedgerTransaction{Meta: xdr.TransactionMeta{
					V: 2,
					V2: &xdr.TransactionMetaV2{
						Operations: make([]xdr.OperationMeta, 1, 1),
					},
				}},
				operation:      tc.op,
				ledgerSequence: 1,
			}

			participants, err := operation.Participants()
			s.Assert().NoError(err)
			s.Assert().ElementsMatch(tc.expected, participants)
		})
	}
}
func TestCreateClaimableBalanceOpTestSuite(t *testing.T) {
	suite.Run(t, new(CreateClaimableBalanceOpTestSuite))
}

type ClaimClaimableBalanceOpTestSuite struct {
	suite.Suite
	op        xdr.Operation
	balanceID string
}

func (s *ClaimClaimableBalanceOpTestSuite) SetupTest() {
	s.balanceID = "00000000da0d57da7d4850e7fc10d2a9d0ebc731f7afb40574c03395b17d49149b91f5be"
	aid := xdr.MustAddress("GDRW375MAYR46ODGF2WGANQC2RRZL7O246DYHHCGWTV2RE7IHE2QUQLD")
	source := aid.ToMuxedAccount()
	var balanceID xdr.ClaimableBalanceId
	xdr.SafeUnmarshalHex(s.balanceID, &balanceID)
	s.op = xdr.Operation{
		SourceAccount: &source,
		Body: xdr.OperationBody{
			Type: xdr.OperationTypeClaimClaimableBalance,
			ClaimClaimableBalanceOp: &xdr.ClaimClaimableBalanceOp{
				BalanceId: balanceID,
			},
		},
	}
}
func (s *ClaimClaimableBalanceOpTestSuite) TestDetails() {
	expected := map[string]interface{}{
		"claimant":   "GDRW375MAYR46ODGF2WGANQC2RRZL7O246DYHHCGWTV2RE7IHE2QUQLD",
		"balance_id": s.balanceID,
	}

	operation := transactionOperationWrapper{
		index: 0,
		transaction: ingest.LedgerTransaction{
			Meta: xdr.TransactionMeta{
				V: 2,
				V2: &xdr.TransactionMetaV2{
					Operations: make([]xdr.OperationMeta, 1, 1),
				},
			}},
		operation:      s.op,
		ledgerSequence: 1,
	}

	details, err := operation.Details()
	s.Assert().NoError(err)
	s.Assert().Equal(expected, details)
}

func (s *ClaimClaimableBalanceOpTestSuite) TestParticipants() {
	operation := transactionOperationWrapper{
		index: 0,
		transaction: ingest.LedgerTransaction{
			Meta: xdr.TransactionMeta{
				V: 2,
				V2: &xdr.TransactionMetaV2{
					Operations: make([]xdr.OperationMeta, 1, 1),
				},
			},
		},
		operation:      s.op,
		ledgerSequence: 1,
	}

	participants, err := operation.Participants()
	s.Assert().NoError(err)
	s.Assert().ElementsMatch([]xdr.AccountId{
		xdr.MustAddress("GDRW375MAYR46ODGF2WGANQC2RRZL7O246DYHHCGWTV2RE7IHE2QUQLD"),
	}, participants)
}

func TestClaimClaimableBalanceOpTestSuite(t *testing.T) {
	suite.Run(t, new(ClaimClaimableBalanceOpTestSuite))
}

var (
	sponsor   = xdr.MustAddress("GAUJETIZVEP2NRYLUESJ3LS66NVCEGMON4UDCBCSBEVPIID773P2W6AY")
	sponsoree = xdr.MustAddress("GA5WBPYA5Y4WAEHXWR2UKO2UO4BUGHUQ74EUPKON2QHV4WRHOIRNKKH2")
)

func getSponsoredSandwichWrappers() []*transactionOperationWrapper {
	const ledgerSeq = uint32(12345)
	tx := createTransaction(true, 3)
	tx.Index = 1
	tx.Meta = xdr.TransactionMeta{
		V: 2,
		V2: &xdr.TransactionMetaV2{
			Operations: make([]xdr.OperationMeta, 3, 3),
		},
	}
	tx.Result = xdr.TransactionResultPair{
		TransactionHash: xdr.Hash{},
		Result: xdr.TransactionResult{
			Result: xdr.TransactionResultResult{
				Code: xdr.TransactionResultCodeTxSuccess,
			},
		},
	}

	// begin sponsorship
	tx.Envelope.Operations()[0].Body = xdr.OperationBody{
		Type: xdr.OperationTypeBeginSponsoringFutureReserves,
		BeginSponsoringFutureReservesOp: &xdr.BeginSponsoringFutureReservesOp{
			SponsoredId: sponsoree,
		},
	}

	sponsorMuxed := sponsor.ToMuxedAccount()
	// Do not provide the source explicitly so that the transaction source is used
	// It tests https://github.com/stellar/go/issues/2982 .
	// tx.Envelope.Operations()[0].SourceAccount = &sponsorMuxed
	tx.Envelope.Operations()[0].SourceAccount = nil
	tx.Envelope.V1.Tx.SourceAccount = sponsorMuxed

	// sponsored operation
	tx.Envelope.Operations()[1].Body = xdr.OperationBody{
		Type: xdr.OperationTypeCreateAccount,
		CreateAccountOp: &xdr.CreateAccountOp{
			Destination: xdr.MustAddress("GC6VKA3RC3CVU7POEKFORVMHWJNQIRZS6AEH3KIIHCVO3YRGWUV7MSUC"),
		},
	}
	sponsoreeMuxed := sponsoree.ToMuxedAccount()
	tx.Envelope.Operations()[1].SourceAccount = &sponsoreeMuxed
	tx.Meta.V2.Operations[1] = xdr.OperationMeta{Changes: []xdr.LedgerEntryChange{
		{
			Type: xdr.LedgerEntryChangeTypeLedgerEntryCreated,
			Created: &xdr.LedgerEntry{
				LastModifiedLedgerSeq: xdr.Uint32(ledgerSeq),
				Ext: xdr.LedgerEntryExt{
					V: 1,
					V1: &xdr.LedgerEntryExtensionV1{
						SponsoringId: &sponsor,
					},
				},
			},
		},
	}}

	// end sponsorship
	tx.Envelope.Operations()[2].Body = xdr.OperationBody{
		Type: xdr.OperationTypeEndSponsoringFutureReserves,
	}
	tx.Envelope.Operations()[2].SourceAccount = &sponsoreeMuxed

	// wrappers
	result := make([]*transactionOperationWrapper, len(tx.Envelope.Operations()), len(tx.Envelope.Operations()))
	for i, op := range tx.Envelope.Operations() {
		result[i] = &transactionOperationWrapper{
			index:          uint32(i),
			transaction:    tx,
			operation:      op,
			ledgerSequence: ledgerSeq,
		}
	}
	return result
}

func TestSponsoredSandwichTransaction_Details(t *testing.T) {
	wrappers := getSponsoredSandwichWrappers()

	details, err := wrappers[0].Details()
	assert.NoError(t, err)
	assert.Equal(t, map[string]interface{}{
		"sponsored_id": "GA5WBPYA5Y4WAEHXWR2UKO2UO4BUGHUQ74EUPKON2QHV4WRHOIRNKKH2",
	}, details)

	details, err = wrappers[1].Details()
	assert.NoError(t, err)
	assert.Equal(t, map[string]interface{}{
		"account":          "GC6VKA3RC3CVU7POEKFORVMHWJNQIRZS6AEH3KIIHCVO3YRGWUV7MSUC",
		"funder":           "GA5WBPYA5Y4WAEHXWR2UKO2UO4BUGHUQ74EUPKON2QHV4WRHOIRNKKH2",
		"sponsor":          "GAUJETIZVEP2NRYLUESJ3LS66NVCEGMON4UDCBCSBEVPIID773P2W6AY",
		"starting_balance": "0.0000000",
	}, details)

	details, err = wrappers[2].Details()
	assert.NoError(t, err)
	assert.Equal(t, map[string]interface{}{
		"begin_sponsor": "GAUJETIZVEP2NRYLUESJ3LS66NVCEGMON4UDCBCSBEVPIID773P2W6AY",
	}, details)
}

func TestSponsoredSandwichTransaction_Participants(t *testing.T) {
	wrappers := getSponsoredSandwichWrappers()

	participants, err := wrappers[0].Participants()
	assert.NoError(t, err)
	assert.ElementsMatch(t,
		[]xdr.AccountId{
			xdr.MustAddress("GAUJETIZVEP2NRYLUESJ3LS66NVCEGMON4UDCBCSBEVPIID773P2W6AY"),
			xdr.MustAddress("GA5WBPYA5Y4WAEHXWR2UKO2UO4BUGHUQ74EUPKON2QHV4WRHOIRNKKH2"),
		},
		participants,
	)

	participants, err = wrappers[1].Participants()
	assert.NoError(t, err)
	assert.ElementsMatch(t,
		[]xdr.AccountId{
			xdr.MustAddress("GA5WBPYA5Y4WAEHXWR2UKO2UO4BUGHUQ74EUPKON2QHV4WRHOIRNKKH2"),
			xdr.MustAddress("GC6VKA3RC3CVU7POEKFORVMHWJNQIRZS6AEH3KIIHCVO3YRGWUV7MSUC"),
			xdr.MustAddress("GAUJETIZVEP2NRYLUESJ3LS66NVCEGMON4UDCBCSBEVPIID773P2W6AY"),
		},
		participants,
	)

	participants, err = wrappers[2].Participants()
	assert.NoError(t, err)
	assert.ElementsMatch(t,
		[]xdr.AccountId{
			xdr.MustAddress("GA5WBPYA5Y4WAEHXWR2UKO2UO4BUGHUQ74EUPKON2QHV4WRHOIRNKKH2"),
			xdr.MustAddress("GAUJETIZVEP2NRYLUESJ3LS66NVCEGMON4UDCBCSBEVPIID773P2W6AY"),
		},
		participants,
	)
}

type ClawbackTestSuite struct {
	suite.Suite
	op        xdr.Operation
	balanceID string
}

func (s *ClawbackTestSuite) SetupTest() {
	aid := xdr.MustAddress("GDRW375MAYR46ODGF2WGANQC2RRZL7O246DYHHCGWTV2RE7IHE2QUQLD")
	source := aid.ToMuxedAccount()
	s.op = xdr.Operation{
		SourceAccount: &source,
		Body: xdr.OperationBody{
			Type: xdr.OperationTypeClawback,
			ClawbackOp: &xdr.ClawbackOp{
				Asset:  xdr.MustNewCreditAsset("USD", "GDRW375MAYR46ODGF2WGANQC2RRZL7O246DYHHCGWTV2RE7IHE2QUQLD"),
				From:   xdr.MustMuxedAddress("GAUJETIZVEP2NRYLUESJ3LS66NVCEGMON4UDCBCSBEVPIID773P2W6AY"),
				Amount: 20,
			},
		},
	}
}
func (s *ClawbackTestSuite) TestDetails() {
	expected := map[string]interface{}{
		"asset_code":   "USD",
		"asset_issuer": "GDRW375MAYR46ODGF2WGANQC2RRZL7O246DYHHCGWTV2RE7IHE2QUQLD",
		"asset_type":   "credit_alphanum4",
		"amount":       "0.0000020",
		"from":         "GAUJETIZVEP2NRYLUESJ3LS66NVCEGMON4UDCBCSBEVPIID773P2W6AY",
	}

	operation := transactionOperationWrapper{
		index: 0,
		transaction: ingest.LedgerTransaction{
			Meta: xdr.TransactionMeta{
				V: 2,
				V2: &xdr.TransactionMetaV2{
					Operations: make([]xdr.OperationMeta, 1, 1),
				},
			}},
		operation:      s.op,
		ledgerSequence: 1,
	}

	details, err := operation.Details()
	s.Assert().NoError(err)
	s.Assert().Equal(expected, details)
}

func (s *ClawbackTestSuite) TestParticipants() {
	operation := transactionOperationWrapper{
		index: 0,
		transaction: ingest.LedgerTransaction{
			Meta: xdr.TransactionMeta{
				V: 2,
				V2: &xdr.TransactionMetaV2{
					Operations: make([]xdr.OperationMeta, 1, 1),
				},
			},
		},
		operation:      s.op,
		ledgerSequence: 1,
	}

	participants, err := operation.Participants()
	s.Assert().NoError(err)
	s.Assert().ElementsMatch([]xdr.AccountId{
		xdr.MustAddress("GDRW375MAYR46ODGF2WGANQC2RRZL7O246DYHHCGWTV2RE7IHE2QUQLD"),
		xdr.MustAddress("GAUJETIZVEP2NRYLUESJ3LS66NVCEGMON4UDCBCSBEVPIID773P2W6AY"),
	}, participants)
}

func TestClawbackTestSuite(t *testing.T) {
	suite.Run(t, new(ClawbackTestSuite))
}

type SetTrustLineFlagsTestSuite struct {
	suite.Suite
	op        xdr.Operation
	balanceID string
}

func (s *SetTrustLineFlagsTestSuite) SetupTest() {
	aid := xdr.MustAddress("GDRW375MAYR46ODGF2WGANQC2RRZL7O246DYHHCGWTV2RE7IHE2QUQLD")
	source := aid.ToMuxedAccount()
	trustor := xdr.MustAddress("GAUJETIZVEP2NRYLUESJ3LS66NVCEGMON4UDCBCSBEVPIID773P2W6AY")
	setFlags := xdr.Uint32(xdr.TrustLineFlagsAuthorizedToMaintainLiabilitiesFlag)
	clearFlags := xdr.Uint32(xdr.TrustLineFlagsTrustlineClawbackEnabledFlag | xdr.TrustLineFlagsAuthorizedFlag)
	s.op = xdr.Operation{
		SourceAccount: &source,
		Body: xdr.OperationBody{
			Type: xdr.OperationTypeSetTrustLineFlags,
			SetTrustLineFlagsOp: &xdr.SetTrustLineFlagsOp{
				Trustor:    trustor,
				Asset:      xdr.MustNewCreditAsset("USD", "GDRW375MAYR46ODGF2WGANQC2RRZL7O246DYHHCGWTV2RE7IHE2QUQLD"),
				ClearFlags: clearFlags,
				SetFlags:   setFlags,
			},
		},
	}
}
func (s *SetTrustLineFlagsTestSuite) TestDetails() {
	expected := map[string]interface{}{
		"asset_code":    "USD",
		"asset_issuer":  "GDRW375MAYR46ODGF2WGANQC2RRZL7O246DYHHCGWTV2RE7IHE2QUQLD",
		"asset_type":    "credit_alphanum4",
		"clear_flags":   []int32{1, 4},
		"clear_flags_s": []string{"authorized", "clawback_enabled"},
		"set_flags":     []int32{2},
		"set_flags_s":   []string{"authorized_to_maintain_liabilites"},
		"trustor":       "GAUJETIZVEP2NRYLUESJ3LS66NVCEGMON4UDCBCSBEVPIID773P2W6AY",
	}

	operation := transactionOperationWrapper{
		index: 0,
		transaction: ingest.LedgerTransaction{
			Meta: xdr.TransactionMeta{
				V: 2,
				V2: &xdr.TransactionMetaV2{
					Operations: make([]xdr.OperationMeta, 1, 1),
				},
			}},
		operation:      s.op,
		ledgerSequence: 1,
	}

	details, err := operation.Details()
	s.Assert().NoError(err)
	s.Assert().Equal(expected, details)
}

func (s *SetTrustLineFlagsTestSuite) TestParticipants() {
	operation := transactionOperationWrapper{
		index: 0,
		transaction: ingest.LedgerTransaction{
			Meta: xdr.TransactionMeta{
				V: 2,
				V2: &xdr.TransactionMetaV2{
					Operations: make([]xdr.OperationMeta, 1, 1),
				},
			},
		},
		operation:      s.op,
		ledgerSequence: 1,
	}

	participants, err := operation.Participants()
	s.Assert().NoError(err)
	s.Assert().ElementsMatch([]xdr.AccountId{
		xdr.MustAddress("GDRW375MAYR46ODGF2WGANQC2RRZL7O246DYHHCGWTV2RE7IHE2QUQLD"),
		xdr.MustAddress("GAUJETIZVEP2NRYLUESJ3LS66NVCEGMON4UDCBCSBEVPIID773P2W6AY"),
	}, participants)
}

func TestSetTrustLineFlagsTestSuite(t *testing.T) {
	suite.Run(t, new(SetTrustLineFlagsTestSuite))
}
